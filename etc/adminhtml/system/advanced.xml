<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * NOTICE OF LICENSE
 *
 * This source file is subject to the MIT License
 * It is available through the world-wide-web at this URL:
 * https://tldrlegal.com/license/mit-license
 * If you are unable to obtain it through the world-wide-web, please send an email
 * to support@buckaroo.nl so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this module to newer
 * versions in the future. If you wish to customize this module for your
 * needs please contact support@buckaroo.nl for more information.
 *
 * @copyright Copyright (c) Buckaroo B.V.
 * @license   https://tldrlegal.com/license/mit-license
 */
 -->
<include xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_include.xsd">

    <group id="buckaroo_magento2_status" translate="label comment" type="text" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Adjust default order statuses</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="order_status_new" translate="label comment" type="select" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>New status</label>
            <comment><![CDATA[This status will be given to new orders.]]></comment>
            <source_model>Buckaroo\Magento2\Model\Config\Source\StatusesNew</source_model>
            <config_path>buckaroo_magento2/account/order_status_new</config_path>
        </field>

        <field id="order_status_pending" translate="label comment" type="select" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Pending payment status</label>
            <comment><![CDATA[This status will be given to orders pending payment.]]></comment>
            <source_model>Buckaroo\Magento2\Model\Config\Source\StatusesPending</source_model>
            <config_path>buckaroo_magento2/account/order_status_pending</config_path>
        </field>

        <field id="order_status_success" translate="label comment" type="select" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Payment success status</label>
            <comment><![CDATA[This status will be given to orders paid.]]></comment>
            <source_model>Buckaroo\Magento2\Model\Config\Source\StatusesSuccess</source_model>
            <config_path>buckaroo_magento2/account/order_status_success</config_path>
        </field>

        <field id="order_status_failed" translate="label comment" type="select" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Payment failed status</label>
            <comment><![CDATA[This status will be given to unsuccessful orders.]]></comment>
            <source_model>Buckaroo\Magento2\Model\Config\Source\StatusesFailed</source_model>
            <config_path>buckaroo_magento2/account/order_status_failed</config_path>
        </field>

        <field id="cancel_on_failed" translate="label comment" type="select" sortOrder="110" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>'Canceled' state on failed payment</label>
            <comment><![CDATA[Orders will stay open after failed payments.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/cancel_on_failed</config_path>
        </field>

        <field id="cancel_on_browser_back" translate="label comment tooltip" type="select" sortOrder="115" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Cancel order on browser back button</label>
            <comment><![CDATA[If disabled, orders will stay in pending state when customer uses browser back button, allowing retry. Buckaroo push notification will handle final cancellation if needed.]]></comment>
            <tooltip><![CDATA[Recommended: No - This allows customers to retry payment and prevents orders from being prematurely canceled. The push notification will cancel orders that are truly abandoned.]]></tooltip>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/cancel_on_browser_back</config_path>
        </field>
    </group>

    <group id="buckaroo_magento2_redirects" translate="label comment" type="text" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Redirect after payment attempt</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="success_redirect" translate="label comment" type="text" sortOrder="90" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Redirect url after 'Success'</label>
            <comment><![CDATA[Redirect after successful payments.]]></comment>
            <config_path>buckaroo_magento2/account/success_redirect</config_path>
        </field>

        <field id="failure_redirect_to_checkout" translate="label comment" type="select" sortOrder="100" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Redirect to checkout payment section after 'Failure'</label>
            <comment><![CDATA[Redirect after failed payments.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/failure_redirect_to_checkout</config_path>
        </field>

        <field id="failure_redirect" translate="label comment" type="text" sortOrder="110" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Redirect url after 'Failure'</label>
            <comment><![CDATA[Redirect after failed payments.]]></comment>
            <config_path>buckaroo_magento2/account/failure_redirect</config_path>
        </field>
    </group>

    <group id="buckaroo_magento2_email" translate="label comment" type="text" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Email settings</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="order_confirmation_email" translate="label comment" type="select" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Send order confirmation email</label>
            <comment><![CDATA[Send a mail after successful creating the order.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/order_confirmation_email</config_path>
        </field>

        <field id="order_confirmation_email_sync" translate="label comment" type="select" sortOrder="55" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Send order confirmation email in sync mode</label>
            <comment><![CDATA[Helps to prevent order status conflicts between cron based (async) processing of emails and order status handling. Redefines "General Settings / Asynchronous sending" setting.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/order_confirmation_email_sync</config_path>
        </field>

        <field id="invoice_email" translate="label comment" type="select" sortOrder="60" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Send transactional invoice email</label>
            <comment><![CDATA[Send a mail after successful payment.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/invoice_email</config_path>
        </field>
    </group>

    <group id="buckaroo_magento2_miscellaneous_section" translate="label" type="text" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Miscellaneous</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="create_order_before_transaction" translate="label comment" type="select" sortOrder="170" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Create order before transaction</label>
            <comment><![CDATA[This will create an order before setting up the transaction with Buckaroo.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/create_order_before_transaction</config_path>
        </field>

        <field id="ip_header" translate="label comment" type="text" sortOrder="180" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Client IP detection headers</label>
            <comment><![CDATA[Optional HTTP headers what will be taken into account for client IP detection. Comma separated list of multiple values is allowed.]]></comment>
            <tooltip>Example: "X-Forwarded-For,CF-Connecting-IP". If "X-Forwarded-For" is empty then "CF-Connecting-IP" will be checked.</tooltip>
            <config_path>buckaroo_magento2/account/ip_header</config_path>
        </field>

        <field id="customer_additional_info" translate="label comment" type="multiselect" sortOrder="200" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Add customer data to request</label>
            <source_model>Buckaroo\Magento2\Model\Config\Source\CustomerAdditionalInfo</source_model>
            <comment><![CDATA[When adding custom fields to your transaction request you have to also add them to your Buckaroo <a href = "https://plaza.buckaroo.nl/Configuration/Merchant/CustomFields" target="_blank"> Plaza </a> account. Click on <a href="https://support.buckaroo.nl/categorie%C3%ABn/plugins/magento-2/faq-magento-2/add-custom-fields-to-transaction-requests" target="_blank"> read more </a> for additional information about adding this fields to the Plaza.]]></comment>
            <config_path>buckaroo_magento2/account/customer_additional_info</config_path>
            <can_be_empty>1</can_be_empty>
        </field>

        <field id="cart_keep_alive" translate="label" type="select" sortOrder="205" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Keep cart alive</label>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <comment><![CDATA[Optional will restore the cart when consumer use back button]]></comment>
            <config_path>buckaroo_magento2/account/cart_keep_alive</config_path>
        </field>

        <field id="advanced_export_giftcards" translate="label comment" type="select" sortOrder="210" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Advanced order export for giftcards</label>
            <comment><![CDATA[Advanced order export, added used gitcards]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/advanced_export_giftcards</config_path>
        </field>
    </group>
</include>

