<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * NOTICE OF LICENSE
 *
 * This source file is subject to the MIT License
 * It is available through the world-wide-web at this URL:
 * https://tldrlegal.com/license/mit-license
 * If you are unable to obtain it through the world-wide-web, please send an email
 * to support@buckaroo.nl so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this module to newer
 * versions in the future. If you wish to customize this module for your
 * needs please contact support@buckaroo.nl for more information.
 *
 * @copyright Copyright (c) Buckaroo B.V.
 * @license   https://tldrlegal.com/license/mit-license
 */
 -->
<include xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_include.xsd">
    <!-- General settings section -->
    <group id="buckaroo_magento2_account_section" translate="label" type="text" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>API Keys</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">1</attribute>

        <field id="active" translate="label comment" type="select" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Enabled</label>
            <comment><![CDATA[Enable or disable the Buckaroo plugin.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/account/active</config_path>
        </field>

        <field id="merchant_key" translate="label comment tooltip" type="obscure" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Store key</label>
            <comment><![CDATA[Enter your Buckaroo store key.]]></comment>
            <tooltip>The Store key can be retrieved in the Buckaroo Plaza under Settings > Websites. For support contact Buckaroo.</tooltip>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>buckaroo_magento2/account/merchant_key</config_path>
        </field>

        <field id="secret_key" translate="label comment tooltip" type="obscure" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Secret key</label>
            <comment><![CDATA[Enter your Buckaroo Secret Key.]]></comment>
            <tooltip>The Secret Key can be retrieved in the Buckaroo Plaza under Settings > Secret Key. For support contact Buckaroo.</tooltip>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>buckaroo_magento2/account/secret_key</config_path>
        </field>

        <field id="credentials_checker" translate="label comment" type="button" sortOrder="35" showInDefault="1" showInWebsite="1" showInStore="1">
            <frontend_model>Buckaroo\Magento2\Block\Adminhtml\System\Config\CredentialsChecker</frontend_model>
            <depends>
                <field id="active" separator=",">1,2</field>
            </depends>
        </field>
    </group>

    <group id="buckaroo_magento2_settings_section" translate="label" type="text" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>General Settings</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="transaction_label" translate="label comment tooltip" type="text" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Transaction label</label>
            <comment><![CDATA[The transaction description, shown in the Buckaroo Plaza and visible on bank account of consumers.]]></comment>
            <tooltip><![CDATA[Available substitutions: <code>{order_number}</code>, <code>{shop_name}</code>, <code>{product_name}</code>(first product name)]]></tooltip>
            <backend_model>Buckaroo\Magento2\Model\Config\Backend\TransactionLabel</backend_model>
            <config_path>buckaroo_magento2/account/transaction_label</config_path>
        </field>

        <field id="invoice_handling" translate="label comment tooltip" type="select" sortOrder="45" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Invoice Handling</label>
            <comment><![CDATA[Select the moment when the invoice should be created.]]></comment>
            <tooltip><![CDATA[Select the moment when the invoice should be created.]]></tooltip>
            <source_model>Buckaroo\Magento2\Model\Config\Source\InvoiceHandlingOptions</source_model>
            <config_path>buckaroo_magento2/account/invoice_handling</config_path>
        </field>

        <field id="buckaroo_fee_tax_class" translate="label tooltip" type="select" sortOrder="47" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Buckaroo Payment Fee Tax Class</label>
            <!--            <comment>This sets whether buckaroo payment fee amounts entered from Magento Admin include tax.</comment>-->
            <source_model>\Magento\Tax\Model\TaxClass\Source\Product</source_model>
            <config_path>buckaroo_magento2/account/buckaroo_fee_tax_class</config_path>
        </field>
    </group>

    <group id="buckaroo_magento2_refund_section" translate="label" type="text" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Refunding</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="active" translate="label comment" type="select" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Enabled</label>
            <comment><![CDATA[Enable or disable refunding.]]></comment>
            <tooltip>Set to 'No' refunds must be done manualy in Buckaroo Plaza.</tooltip>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/refund/enabled</config_path>
        </field>

        <field id="allow_push" translate="label comment tooltip" type="select" sortOrder="20" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Push Buckaroo Plaza refunds to Magento</label>
            <comment><![CDATA[Allow 2-way refunding from Magento and Buckaroo Plaza.]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/refund/allow_push</config_path>
            <depends>
                <field id="active">1</field>
            </depends>
        </field>

        <field id="refund_label" translate="label comment tooltip" type="text" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="1">
            <label>Refund label</label>
            <comment><![CDATA[The refund description, shown in Buckaroo plaza and visible on bank account of consumers.]]></comment>
            <tooltip><![CDATA[Available substitutions: <code>{order_number}</code>, <code>{shop_name}</code>, <code>{product_name}</code>(first product name)]]></tooltip>
            <backend_model>Buckaroo\Magento2\Model\Config\Backend\TransactionLabel</backend_model>
            <config_path>buckaroo_magento2/account/refund_label</config_path>
            <depends>
                <field id="active">1</field>
            </depends>
        </field>

        <field id="pending_approval" translate="label comment tooltip" type="select" sortOrder="20" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Create Refund on Approve for Pending Approval Refunds</label>
            <comment><![CDATA[Yes - Create CreditMemo after approve from Plaza <br> No - Create CreditMemo on Request with status "Pending"]]></comment>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <config_path>buckaroo_magento2/refund/pending_approval</config_path>
            <depends>
                <field id="active">1</field>
            </depends>
        </field>
    </group>

    <group id="buckaroo_magento2_logging_section" translate="label" type="text" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Logging</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <field id="log_level" translate="label comment" type="multiselect" sortOrder="220" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Log level</label>
            <source_model>Buckaroo\Magento2\Model\Config\Source\LogLevel</source_model>
            <comment><![CDATA[Decide what to debug. Log files will be created within the var/log/Buckaroo/ directory.]]></comment>
            <config_path>buckaroo_magento2/account/debug_types</config_path>
        </field>

        <field id="log_handler" translate="label" type="select" sortOrder="250" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Log Handler</label>
            <source_model>Buckaroo\Magento2\Model\Config\Source\LogHandler</source_model>
            <comment><![CDATA[Decide what Logging Handler used]]></comment>
            <config_path>buckaroo_magento2/account/log_handler</config_path>
        </field>

        <field id="log_handler_db_depth" translate="label" type="text" sortOrder="255" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Debug backtrace logging depth</label>
            <comment><![CDATA[Depth for debug backtrace. Default 10]]></comment>
            <config_path>buckaroo_magento2/account/log_handler_db_depth</config_path>
        </field>

        <field id="log_retention" translate="label" type="multiselect" sortOrder="260" showInDefault="1" showInWebsite="0" showInStore="0">
            <label>Log retention period</label>
            <source_model>Buckaroo\Magento2\Model\Config\Source\LogRetention</source_model>
            <comment><![CDATA[Decide what period will be for log retention]]></comment>
            <config_path>buckaroo_magento2/account/log_retention</config_path>
        </field>
    </group>

    <group id="buckaroo_magento2_advanced" translate="label" type="text" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="1">
        <label>Advanced</label>
        <fieldset_css>buckaroo_magento2-section</fieldset_css>
        <attribute type="expanded">0</attribute>

        <include path="Buckaroo_Magento2::system/advanced.xml"/>
    </group>
</include>
