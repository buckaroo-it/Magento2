<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * NOTICE OF LICENSE
 *
 * This source file is subject to the MIT License
 * It is available through the world-wide-web at this URL:
 * https://tldrlegal.com/license/mit-license
 * If you are unable to obtain it through the world-wide-web, please send an email
 * to support@buckaroo.nl so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this module to newer
 * versions in the future. If you wish to customize this module for your
 * needs please contact support@buckaroo.nl for more information.
 *
 * @copyright Copyright (c) Buckaroo B.V.
 * @license   https://tldrlegal.com/license/mit-license
 */
 -->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <preference for="Magento\Payment\Gateway\Data\Order\OrderAdapter" type="Buckaroo\Magento2\Gateway\Data\Order\OrderAdapter"/>
    <preference for="Buckaroo\Magento2\Api\CertificateRepositoryInterface" type="Buckaroo\Magento2\Model\CertificateRepository"/>
    <preference for="Buckaroo\Magento2\Api\InvoiceRepositoryInterface" type="Buckaroo\Magento2\Model\InvoiceRepository"/>
    <preference for="Buckaroo\Magento2\Api\GiftcardRepositoryInterface" type="Buckaroo\Magento2\Model\GiftcardRepository"/>
    <preference for="Buckaroo\Magento2\Api\GroupTransactionRepositoryInterface" type="Buckaroo\Magento2\Model\GroupTransactionRepository"/>
    <preference for="Buckaroo\Magento2\Api\PushInterface" type="Buckaroo\Magento2\Model\Push"/>
    <preference for="Buckaroo\Magento2\Api\PaymentInformationManagementInterface" type="Buckaroo\Magento2\Model\PaymentInformationManagement"/>
    <preference for="Buckaroo\Magento2\Api\GuestPaymentInformationManagementInterface" type="Buckaroo\Magento2\Model\GuestPaymentInformationManagement"/>
    <preference for="Magento\Quote\Model\Cart\CartTotalRepository" type="Buckaroo\Magento2\Model\Cart\CartTotalRepository" />
    <preference for="Magento\Sales\Model\ResourceModel\Order\Handler\State" type="Buckaroo\Magento2\Model\ResourceModel\Order\Handler\State" />
    <preference for="Onestepcheckout\Iosc\Plugin\GuestSaveManager" type="Buckaroo\Magento2\Plugin\GuestSaveManager" />
    <preference for="Magento\Payment\Model\Checks\CanUseForCountry\CountryProvider" type="Buckaroo\Magento2\Model\Checks\CanUseForCountry\CountryProvider" />
    <preference for="Mageplaza\Osc\Model\CheckoutManagement" type="Buckaroo\Magento2\Plugin\CheckoutManagement" />
    <preference for="Magento\Ui\Model\Export\ConvertToCsv" type="Buckaroo\Magento2\Model\Export\ConvertToCsv" />
    <preference for="Magento\Sales\Model\Order\CreditmemoFactory" type="Buckaroo\Magento2\Model\Order\CreditmemoFactory" />


      <!-- giftcard rest api -->
    <preference for="Buckaroo\Magento2\Model\Voucher\ApplyVoucherRequestInterface" type="Buckaroo\Magento2\Model\Voucher\ApplyVoucherRequest"/>
    <preference for="Buckaroo\Magento2\Api\ApplyVoucherInterface" type="Buckaroo\Magento2\Model\Voucher\ApplyVoucher"/>
    <!-- end gifcard rest api -->


      <!-- giftcard rest api -->
    <preference for="Buckaroo\Magento2\Model\Voucher\ApplyVoucherRequestInterface" type="Buckaroo\Magento2\Model\Voucher\ApplyVoucherRequest"/>
    <preference for="Buckaroo\Magento2\Api\ApplyVoucherInterface" type="Buckaroo\Magento2\Model\Voucher\ApplyVoucher"/>
    <!-- end gifcard rest api -->

    <!-- giftcard rest api -->
    <preference for="Buckaroo\Magento2\Api\PayWithGiftcardInterface" type="Buckaroo\Magento2\Model\Giftcard\Api\Pay"/>
    <preference for="Buckaroo\Magento2\Model\Giftcard\Request\GiftcardInterface" type="Buckaroo\Magento2\Model\Giftcard\Request\Giftcard"/>
    <preference for="Buckaroo\Magento2\Api\Data\Giftcard\PayResponseSetInterface" type="Buckaroo\Magento2\Model\Giftcard\Api\PayResponse"/>

    <preference for="Buckaroo\Magento2\Api\Data\Giftcard\TransactionResponseInterface" type="Buckaroo\Magento2\Model\Giftcard\Api\TransactionResponse"/>
    <preference for="Buckaroo\Magento2\Api\Data\Giftcard\GetTransactionsResponseInterface" type="Buckaroo\Magento2\Model\Giftcard\Api\GetTransactionsResponse"/>
    <preference for="Buckaroo\Magento2\Api\Data\Giftcard\PayRequestInterface" type="Buckaroo\Magento2\Model\Giftcard\Api\PayRequest"/>
    <preference for="Buckaroo\Magento2\Api\GiftcardTransactionInterface" type="Buckaroo\Magento2\Model\Giftcard\Api\GetTransactions"/>
    <!-- end gifcard rest api -->

    <!-- paypal-express -->
    <preference for="Buckaroo\Magento2\Model\PaypalExpress\QuoteBuilderInterface" type="Buckaroo\Magento2\Model\PaypalExpress\QuoteBuilder" />

    <preference for="Buckaroo\Magento2\Api\PaypalExpressQuoteCreateInterface" type="Buckaroo\Magento2\Model\PaypalExpress\QuoteCreate" />

    <preference for="Buckaroo\Magento2\Api\Data\PaypalExpress\QuoteCreateResponseInterface" type="Buckaroo\Magento2\Model\PaypalExpress\Response\QuoteCreate" />
    <preference for="Buckaroo\Magento2\Api\Data\PaypalExpress\TotalBreakdownInterface" type="Buckaroo\Magento2\Model\PaypalExpress\Response\TotalBreakdown" />
    <preference for="Buckaroo\Magento2\Api\Data\PaypalExpress\BreakdownItemInterface" type="Buckaroo\Magento2\Model\PaypalExpress\Response\BreakdownItem" />

    <preference for="Buckaroo\Magento2\Api\Data\PaypalExpress\OrderDataItemInterface" type="Buckaroo\Magento2\Model\PaypalExpress\Request\OrderDataItem" />
    <preference for="Buckaroo\Magento2\Api\Data\PaypalExpress\ShippingAddressRequestInterface" type="Buckaroo\Magento2\Model\PaypalExpress\Request\ShippingAddress" />

    <preference for="Buckaroo\Magento2\Api\PaypalExpressOrderCreateInterface" type="Buckaroo\Magento2\Model\PaypalExpress\OrderCreate" />

    <preference for="Buckaroo\Magento2\Api\Data\PaypalExpress\OrderCreateResponseInterface" type="Buckaroo\Magento2\Model\PaypalExpress\Response\OrderCreate" />
    <!-- end paypal-express -->

    <preference for="Buckaroo\Magento2\Api\TransactionResponseInterface" type="Buckaroo\Magento2\Model\Transaction\Status\Response" />

    <type name="Magento\Checkout\Controller\Onepage\Success">
        <plugin name="buckaroo_magento2_checkout_success" type="Buckaroo\Magento2\Plugin\Onepage\Success" />
    </type>

    <type name="Magento\Sales\Api\OrderRepositoryInterface">
        <plugin name="buckaroo_magento2_add_order_extension_attributes" type="Buckaroo\Magento2\Plugin\OrderExtensionAttribute" />
    </type>

    <type name="Magento\Sales\Api\CreditmemoRepositoryInterface">
        <plugin name="buckaroo_magento2_add_creditmemo_extension_attributes" type="Buckaroo\Magento2\Plugin\CreditmemoExtensionAttribute" />
    </type>

    <type name="Magento\Sales\Model\Order">
        <plugin name="buckaroo_magento2_plugin_afterpay" type="Buckaroo\Magento2\Plugin\Method\Afterpay"/>
        <plugin name="buckaroo_magento2_plugin_afterpay2" type="Buckaroo\Magento2\Plugin\Method\Afterpay2"/>
        <plugin name="buckaroo_magento2_plugin_klarna" type="Buckaroo\Magento2\Plugin\Method\Klarna"/>
        <plugin name="buckaroo_magento2_plugin_klarnakp" type="Buckaroo\Magento2\Plugin\Method\Klarnakp"/>
        <plugin name="buckaroo_magento2_plugin_klarnain" type="Buckaroo\Magento2\Plugin\Method\Klarnain"/>
        <plugin name="buckaroo_magento2_plugin_emandate" type="Buckaroo\Magento2\Plugin\Method\Emandate"/>
    </type>

    <type name="Buckaroo\Magento2\Plugin\Method\Afterpay">
        <arguments>
            <argument name="paymentMethod" xsi:type="object">AfterpayOldFacade</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Plugin\Method\Afterpay2">
        <arguments>
            <argument name="paymentMethod" xsi:type="object">AfterpayFacade</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Plugin\Method\Klarna">
        <arguments>
            <argument name="paymentMethod" xsi:type="object">KlarnaFacade</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Plugin\Method\Klarnakp">
        <arguments>
            <argument name="paymentMethod" xsi:type="object">KlarnaKpFacade</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Plugin\Method\Klarnain">
        <arguments>
            <argument name="paymentMethod" xsi:type="object">KlarnaInFacade</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Plugin\Method\Emandate">
        <arguments>
            <argument name="paymentMethod" xsi:type="object">EmandateFacade</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\Push">
        <plugin name="buckaroo_magento2_paypal_sellersprotection_push" type="Buckaroo\Magento2\Model\Service\Plugin\PaypalSellersProtection\Push" />
        <plugin name="buckaroo_magento2_mpi_push" type="Buckaroo\Magento2\Model\Service\Plugin\Mpi\Push" />
        <arguments>
            <argument name="fileSystemDriver" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>

    <type name="Magento\Sales\Model\Order\Payment\State\OrderCommand">
        <plugin name="buckaroo_magento2_plugin_commandInterface" type="Buckaroo\Magento2\Plugin\CommandInterface" />
    </type>

    <type name="Magento\Sales\Model\Order\Payment\State\AuthorizeCommand">
        <plugin name="buckaroo_magento2_plugin_commandInterface" type="Buckaroo\Magento2\Plugin\CommandInterface" />
    </type>

    <type name="Buckaroo\Magento2\Model\PaymentInformationManagement">
        <arguments>
            <argument name="registry" xsi:type="object">Magento\Framework\Registry</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\GuestPaymentInformationManagement">
        <arguments>
            <argument name="registry" xsi:type="object">Magento\Framework\Registry</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\ValidatorFactory">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="push" xsi:type="array">
                    <item name="type" xsi:type="string">push</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\Validator\Push</item>
                </item>
                <item name="transaction_response" xsi:type="array">
                    <item name="type" xsi:type="string">transaction_response</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\Validator\TransactionResponse</item>
                </item>
                <item name="transaction_response_status" xsi:type="array">
                    <item name="type" xsi:type="string">transaction_response_status</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\Validator\TransactionResponseStatus</item>
                </item>
                <item name="redirect_process" xsi:type="array">
                    <item name="type" xsi:type="string">redirect_return</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\Validator\RedirectProcess</item>
                </item>
                <item name="amount" xsi:type="array">
                    <item name="type" xsi:type="string">amount</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\Validator\Amount</item>
                </item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\Validator\TransactionResponse">
        <arguments>
            <argument name="publicKeyConfigProvider" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\PublicKey</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\Validator\TransactionResponseStatus">
        <arguments>
            <argument name="helper" xsi:type="object">Buckaroo\Magento2\Helper\Data</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\ResourceModel\Certificate">
        <arguments>
            <argument name="dateTime" xsi:type="object">Magento\Framework\Stdlib\DateTime\DateTime</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\ConfigProvider\Method\Factory">
        <arguments>
            <argument name="configProviders" xsi:type="array">
                <item name="ideal" xsi:type="array">
                    <item name="type" xsi:type="string">ideal</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Ideal</item>
                </item>
                <item name="idealprocessing" xsi:type="array">
                    <item name="type" xsi:type="string">idealprocessing</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\IdealProcessing</item>
                </item>
                <item name="creditcard" xsi:type="array">
                    <item name="type" xsi:type="string">creditcard</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcard</item>
                </item>
                <item name="creditcards" xsi:type="array">
                    <item name="type" xsi:type="string">creditcards</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcards</item>
                </item>
                <item name="giropay" xsi:type="array">
                    <item name="type" xsi:type="string">giropay</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Giropay</item>
                </item>
                <item name="mrcash" xsi:type="array">
                    <item name="type" xsi:type="string">mrcash</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Mrcash</item>
                </item>
                <item name="paypal" xsi:type="array">
                    <item name="type" xsi:type="string">paypal</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Paypal</item>
                </item>
                <item name="payconiq" xsi:type="array">
                    <item name="type" xsi:type="string">payconiq</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Payconiq</item>
                </item>
                <item name="sepadirectdebit" xsi:type="array">
                    <item name="type" xsi:type="string">sepadirectdebit</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\SepaDirectDebit</item>
                </item>
                <item name="sofortbanking" xsi:type="array">
                    <item name="type" xsi:type="string">sofortbanking</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Sofortbanking</item>
                </item>
                <item name="belfius" xsi:type="array">
                    <item name="type" xsi:type="string">belfius</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Belfius</item>
                </item>
                <item name="transfer" xsi:type="array">
                    <item name="type" xsi:type="string">transfer</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Transfer</item>
                </item>
                <item name="afterpay" xsi:type="array">
                    <item name="type" xsi:type="string">afterpay</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay</item>
				</item>
                <item name="afterpay2" xsi:type="array">
                    <item name="type" xsi:type="string">afterpay2</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay2</item>
				</item>
                <item name="afterpay20" xsi:type="array">
                    <item name="type" xsi:type="string">afterpay20</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay20</item>
                </item>
                <item name="billink" xsi:type="array">
                    <item name="type" xsi:type="string">billink</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Billink</item>
                </item>
                <item name="payperemail" xsi:type="array">
                    <item name="type" xsi:type="string">payperemail</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\PayPerEmail</item>
                </item>
                <item name="paylink" xsi:type="array">
                    <item name="type" xsi:type="string">paylink</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\PayLink</item>
                </item>
                <item name="eps" xsi:type="array">
                    <item name="type" xsi:type="string">eps</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Eps</item>
                </item>
                <item name="giftcards" xsi:type="array">
                    <item name="type" xsi:type="string">giftcards</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Giftcards</item>
                </item>
                <item name="kbc" xsi:type="array">
                    <item name="type" xsi:type="string">kbc</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Kbc</item>
                </item>
                <item name="klarna" xsi:type="array">
                    <item name="type" xsi:type="string">klarna</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarna</item>
                </item>
                <item name="klarnakp" xsi:type="array">
                    <item name="type" xsi:type="string">klarnakp</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarnakp</item>
                </item>
                <item name="klarnain" xsi:type="array">
                    <item name="type" xsi:type="string">klarnain</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarnain</item>
                </item>
                <item name="emandate" xsi:type="array">
                    <item name="type" xsi:type="string">emandate</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Emandate</item>
                </item>
                <item name="applepay" xsi:type="array">
                    <item name="type" xsi:type="string">applepay</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Applepay</item>
                </item>
                <item name="capayablein3" xsi:type="array">
                    <item name="type" xsi:type="string">capayablein3</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\CapayableIn3</item>
                </item>
                <item name="capayablepostpay" xsi:type="array">
                    <item name="type" xsi:type="string">capayablepostpay</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\CapayablePostpay</item>
                </item>
                <item name="alipay" xsi:type="array">
                    <item name="type" xsi:type="string">alipay</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Alipay</item>
                </item>
                <item name="wechatpay" xsi:type="array">
                    <item name="type" xsi:type="string">wechatpay</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Wechatpay</item>
                </item>
                <item name="p24" xsi:type="array">
                    <item name="type" xsi:type="string">p24</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\P24</item>
                </item>
                <item name="trustly" xsi:type="array">
                    <item name="type" xsi:type="string">trustly</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Trustly</item>
                </item>
                <item name="rtp" xsi:type="array">
                    <item name="type" xsi:type="string">rtp</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Rtp</item>
                </item>
                <item name="pospayment" xsi:type="array">
                    <item name="type" xsi:type="string">pospayment</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Pospayment</item>
                </item>
                <item name="tinka" xsi:type="array">
                    <item name="type" xsi:type="string">tinka</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Tinka</item>
                </item>
                <item name="creditclick" xsi:type="array">
                    <item name="type" xsi:type="string">creditclick</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\CreditClick</item>
                </item>
                <item name="voucher" xsi:type="array">
                    <item name="type" xsi:type="string">voucher</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Method\Voucher</item>
                </item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\ConfigProvider\Factory">
        <arguments>
            <argument name="configProviders" xsi:type="array">
                <item name="account" xsi:type="array">
                    <item name="type" xsi:type="string">account</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Account</item>
                </item>
                <item name="private_key" xsi:type="array">
                    <item name="type" xsi:type="string">private_key</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\PrivateKey</item>
                </item>
                <item name="public_key" xsi:type="array">
                    <item name="type" xsi:type="string">public_key</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\PublicKey</item>
                </item>
                <item name="states" xsi:type="array">
                    <item name="type" xsi:type="string">states</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\States</item>
                </item>
                <item name="buckaroo_fee" xsi:type="array">
                    <item name="type" xsi:type="string">buckaroo_fee</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\BuckarooFee</item>
                </item>
                <item name="allowed_currencies" xsi:type="array">
                    <item name="type" xsi:type="string">allowed_currencies</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\AllowedCurrencies</item>
                </item>
                <item name="refund" xsi:type="array">
                    <item name="type" xsi:type="string">refund</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Model\ConfigProvider\Refund</item>
                </item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Logging\InternalLogger">
        <arguments>
            <argument name="name" xsi:type="string">buckaroo_logging</argument>
            <argument name="handlers"  xsi:type="array">
                <item name="exception" xsi:type="object">Buckaroo\Magento2\Logging\CriticalHandler</item>
                <item name="debug" xsi:type="object">Buckaroo\Magento2\Logging\DebugHandler</item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Block\Adminhtml\Sales\Order\Creditmemo\Create\BankFields">
        <arguments>
            <argument name="refundFieldsFactory" xsi:type="object">Buckaroo\Magento2\Model\RefundFieldsFactory</argument>
        </arguments>
    </type>

    <type name="Magento\Framework\Webapi\Rest\Request\DeserializerFactory">
        <arguments>
            <argument name="deserializers" xsi:type="array">
                <item name="application_x-www-form-urlencoded" xsi:type="array">
                    <item name="type" xsi:type="string">application/x-www-form-urlencoded</item>
                    <item name="model" xsi:type="string">Buckaroo\Magento2\Webapi\Rest\Request\Deserializer\XWwwFormUrlencoded</item>
                </item>
                <item name="application_json" xsi:type="array">
                    <item name="type" xsi:type="string">application/json</item>
                    <item name="model" xsi:type="string">Magento\Framework\Webapi\Rest\Request\Deserializer\Json</item>
                </item>
                <item name="application_xml" xsi:type="array">
                    <item name="type" xsi:type="string">application/xml</item>
                    <item name="model" xsi:type="string">Magento\Framework\Webapi\Rest\Request\Deserializer\Xml</item>
                </item>
                <item name="application_xhtml_xml" xsi:type="array">
                    <item name="type" xsi:type="string">application/xhtml+xml</item>
                    <item name="model" xsi:type="string">Magento\Framework\Webapi\Rest\Request\Deserializer\Xml</item>
                </item>
                <item name="text_xml" xsi:type="array">
                    <item name="type" xsi:type="string">text/xml</item>
                    <item name="model" xsi:type="string">Magento\Framework\Webapi\Rest\Request\Deserializer\Xml</item>
                </item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\RefundFieldsFactory">
    </type>

    <type name="Magento\Quote\Model\Cart\CartTotalRepository">
        <plugin name="buckaroo_magento2_fee_total" type="Buckaroo\Magento2\Plugin\CartTotalRepository" />
    </type>

    <type name="Magento\Quote\Model\Quote\TotalsCollector">
        <plugin name="buckaroo_magento2_fee_total_collector" type="Buckaroo\Magento2\Plugin\TotalsCollector" />
    </type>

    <type name="Magento\Quote\Model\Cart\TotalsConverter">
        <plugin name="buckaroo_magento2_fee_total_converter" type="Buckaroo\Magento2\Plugin\TotalsConverter" />
    </type>

    <type name="Buckaroo\Magento2\Block\Info\Creditcard">
        <arguments>
            <argument name="configProvider" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcard</argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Model\ConfigProvider\CompositeConfigProvider">
        <arguments>
            <argument name="configProviders" xsi:type="array">
                <item name="buckaroo_magento2_configprovider_account" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Account</item>
                <item name="buckaroo_magento2_configprovider_buckaroofee" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\BuckarooFee</item>
                <item name="buckaroo_magento2_configprovider_privatekey" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Privatekey</item>
                <item name="buckaroo_magento2_configprovider_publickey" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Publickey</item>
                <item name="buckaroo_magento2_configprovider_refund" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Refund</item>
                <item name="buckaroo_magento2_configprovider_states" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\States</item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Gateway\Http\TransactionBuilder\AbstractTransactionBuilder">
        <arguments>
            <argument name="urlBuilder" xsi:type="object">Magento\Framework\Url</argument>
        </arguments>
    </type>

    <type name="Magento\Framework\View\Asset\Minification">
        <plugin name="my-exclude" type="Buckaroo\Magento2\Plugin\ExcludeFilesFromMinification" />
    </type>

    <type name="MyParcelNL\Magento\Model\Checkout\ShippingMethods">
        <plugin name="myParcelNLBuckarooPlugin" type="Buckaroo\Magento2\Plugin\MyParcelNLBuckarooPlugin" />
    </type>

    <preference for="Buckaroo\Magento2\Api\LogRepositoryInterface" type="Buckaroo\Magento2\Model\LogRepository"/>
	<preference for="Buckaroo\Magento2\Api\Data\LogInterface" type="Buckaroo\Magento2\Model\Data\Log"/>
	<preference for="Buckaroo\Magento2\Api\Data\LogSearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
	<virtualType name="Buckaroo\Magento2\Model\ResourceModel\Log\Grid\Collection" type="Magento\Framework\View\Element\UiComponent\DataProvider\SearchResult">
		<arguments>
			<argument name="mainTable" xsi:type="string">buckaroo_magento2_log</argument>
			<argument name="resourceModel" xsi:type="string">Buckaroo\Magento2\Model\ResourceModel\Log\Collection</argument>
		</arguments>
	</virtualType>
	<type name="Magento\Framework\View\Element\UiComponent\DataProvider\CollectionFactory">
		<arguments>
			<argument name="collections" xsi:type="array">
				<item name="buckaroo_magento2_log_listing_data_source" xsi:type="string">Buckaroo\Magento2\Model\ResourceModel\Log\Grid\Collection</item>
			</argument>
		</arguments>
	</type>

    <type name="Magento\CatalogInventory\Model\Configuration">
        <plugin name="buckarooCatalogInventoryConfiguration" type="Buckaroo\Magento2\Plugin\CatalogInventory\Model\Configuration" />
    </type>

    <type name="Magento\Checkout\Api\PaymentInformationManagementInterface">
        <plugin name="buckarooPaymentInformationManagement" type="Buckaroo\Magento2\Plugin\PaymentMethodManagement"/>
    </type>

    <type name="Magento\Checkout\Api\GuestPaymentInformationManagementInterface">
        <plugin name="buckarooGuestPaymentInformationManagement" type="Buckaroo\Magento2\Plugin\GuestPaymentMethodManagement"/>
    </type>

    <type name="Magento\Framework\Console\CommandListInterface">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="buckaroo_pushsend" xsi:type="object">Buckaroo\Magento2\Console\Command\PushSend\Proxy</item>
            </argument>
        </arguments>
    </type>

    <!-- Buckaroo Payment Provider Gateway -->
    <type name="Buckaroo\Magento2\Model\Adapter\BuckarooAdapter">
        <arguments>
            <argument name="mapPaymentMethods" xsi:type="array">
                <item name="klaranain" xsi:type="string">klarna</item>
                <item name="p24" xsi:type="string">przelewy24</item>
                <item name="kbc" xsi:type="string">kbcpaymentbutton</item>
                <item name="Capayable" xsi:type="string">in3</item>
                <item name="afterpay20" xsi:type="string">afterpay</item>
                <item name="afterpay" xsi:type="string">afterpaydigiaccept</item>
                <item name="giftcards" xsi:type="string">giftcard</item>
                <item name="rtp" xsi:type="string">requesttopay</item>
                <item name="sofortbanking" xsi:type="string">sofortueberweisung</item>
                <item name="creditcards" xsi:type="string">creditcard</item>
                <item name="emandate" xsi:type="string">emandates</item>
                <item name="mrcash" xsi:type="string">bancontactmrcash</item>
            </argument>
        </arguments>
    </type>

    <!-- Buckaroo Payment Provider Gateway Availability Validators -->
    <virtualType name="BuckarooAvailabilityValidator" type="Magento\Payment\Gateway\Validator\ValidatorComposite">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="account_config" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\ActiveAccountValidator</item>
                <item name="area_code" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\AreaCodeValidator</item>
                <item name="based_on_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\AvailableBasedOnIPValidator</item>
                <item name="based_on_amount" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\AvailableBasedOnAmountValidator</item>
                <item name="based_on_currency" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\AvailableBasedOnCurrencyValidator</item>
            </argument>
            <argument name="chainBreakingValidators" xsi:type="array">
                <item name="account_config" xsi:type="string">account_config</item>
                <item name="area_code" xsi:type="string">area_code</item>
                <item name="based_on_ip" xsi:type="string">based_on_ip</item>
                <item name="based_on_amount" xsi:type="string">based_on_amount</item>
                <item name="based_on_currency" xsi:type="string">based_on_currency</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Magento\Payment\Gateway\Command\CommandManagerPool">
        <arguments>
            <argument name="executors" xsi:type="array">
                <item name="buckaroo" xsi:type="string">BuckarooCommandManager</item>
            </argument>
        </arguments>
    </type>

    <!-- Command managers section -->
    <virtualType name="BuckarooCommandManager" type="Magento\Payment\Gateway\Command\CommandManager">
        <arguments>
            <argument name="commandPool" xsi:type="object">BuckarooCommandPool</argument>
        </arguments>
    </virtualType>

    <!-- Commands infrastructure -->
    <virtualType name="BuckarooCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="paylink" xsi:type="string">PayLinkCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Additional Parameters Data Builder Types -->
    <virtualType name="AdditionalParametersOrderDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">order</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersRefundDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">refund</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersPayDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">pay</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersPayInInstallmentsDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">payininstallments</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersReserveDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">reserve</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersAuthorizeDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">authorize</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersCaptureDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">capture</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersCancelDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">cancelauthorize</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersPayPerEmailDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">fromPayPerEmail</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersPayLinkDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">fromPayLink</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdditionalParametersCreateMandateDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BasicParameter\AdditionalParametersDataBuilder">
        <arguments>
            <argument name="action" xsi:type="string">createmandate</argument>
        </arguments>
    </virtualType>
    <!-- END Additional Parameters Data Builder Types -->

    <!-- Gateway Client Types -->
    <virtualType name="TransactionAuthorize" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::AUTHORIZE</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionAuthorizeEncrypted" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::AUTHORIZE_ENCRYPTED</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionCancel" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::CANCEL</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionCancelReserve" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::CANCEL_RESERVE</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionCapture" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::CAPTURE</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionPay" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::PAY</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionPayInInstallments" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::PAY_IN_INSTALLMENTS</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionPayRedirect" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::PAY_REDIRECT</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionRefund" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::REFUND</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionCreditManagmentVoid" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::CREATE_CREDIT_NOTE</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionReserve" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::RESERVE</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionPayRedirect" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::PAY_REDIRECT</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionCreateMandate" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::CREATE_MANDATE</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionPaymentInvitation" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::PAYMENT_INVITATION</argument>
        </arguments>
    </virtualType>
    <virtualType name="TransactionVerify" type="Buckaroo\Magento2\Gateway\Http\Client\DefaultTransaction">
        <arguments>
            <argument name="action" xsi:type="const">Buckaroo\Magento2\Gateway\Http\Client\TransactionType::VERIFY</argument>
        </arguments>
    </virtualType>
    <!-- END Gateway Client Types -->

    <!-- Message Mapper -->
    <virtualType name="Buckaroo\Magento2\Gateway\ErrorMapper\VirtualConfigReader" type="Magento\Payment\Gateway\ErrorMapper\VirtualConfigReader">
        <arguments>
            <argument name="fileName" xsi:type="string">buckaroo_error_mapping.xml</argument>
        </arguments>
    </virtualType>
    <virtualType name="Buckaroo\Magento2\Gateway\ErrorMapper\VirtualMappingData" type="Magento\Payment\Gateway\ErrorMapper\MappingData">
        <arguments>
            <argument name="reader" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualConfigReader</argument>
            <argument name="cacheId" xsi:type="string">buckaroo_error_mapper</argument>
        </arguments>
    </virtualType>
    <virtualType name="Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper" type="Magento\Payment\Gateway\ErrorMapper\ErrorMessageMapper">
        <arguments>
            <argument name="messageMapping" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualMappingData</argument>
        </arguments>
    </virtualType>
    <!-- END Message Mapper -->

    <!-- Buckaroo AddressHandlerPool - Change Shipping Request by Delivery Methods-->
    <type name="Buckaroo\Magento2\Gateway\Request\AddressHandlerPool">
        <arguments>
            <argument name="addressHandlers" xsi:type="array">
                <item name="postnl_postnl" xsi:type="object">Buckaroo\Magento2\Gateway\Request\AddressHandler\PostNLAddressHandler\Proxy</item>
                <item name="dpdpickup_dpdpickup" xsi:type="object">Buckaroo\Magento2\Gateway\Request\AddressHandler\DPDPickupAddressHandler\Proxy</item>
                <item name="dhlparcel_servicepoint" xsi:type="object">Buckaroo\Magento2\Gateway\Request\AddressHandler\DHLParcelAddressHandler\Proxy</item>
                <item name="sendcloud_sendcloud" xsi:type="object">Buckaroo\Magento2\Gateway\Request\AddressHandler\SendCloudAddressHandler\Proxy</item>
                <item name="myparcel_myparcel" xsi:type="object">Buckaroo\Magento2\Gateway\Request\AddressHandler\MyParcelAddressHandler\Proxy</item>
            </argument>
        </arguments>
    </type>

    <type name="Buckaroo\Magento2\Gateway\Request\Articles\ArticlesHandler\ArticlesHandlerFactory">
        <arguments>
            <argument name="articlesHandlers" xsi:type="array">
                <item name="default" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesHandler\DefaultHandler</item>
                <item name="afterpay" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesHandler\AfterpayOldHandler</item>
                <item name="tinka" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesHandler\TinkaHandler</item>
            </argument>
        </arguments>
    </type>

    <!-- Buckaroo Commands infrastructure -->
    <virtualType name="BuckarooGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">BuckarooOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Buckaroo Order Command -->
    <virtualType name="BuckarooOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Buckaroo Order Command - Request Builder -->
    <virtualType name="BuckarooOrderRequest" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_debit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountDebitDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="BuckarooPayRemainderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="amount" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PayReminder\AmountDataBuilder</item>
                <item name="original_transaction_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PayReminder\OriginalTransactionKeyDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Order Command - Response Handler -->
    <virtualType name="OrderResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\OrderHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Buckaroo Order Command -->

    <!-- Buckaroo Authorize Command - Response Handler -->
    <virtualType name="AuthorizeResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\AuthorizeHandler</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="BuckarooCaptureCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooCaptureRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionCapture</argument>
            <argument name="handler" xsi:type="object">CaptureResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Buckaroo Capture Command - Response Handler -->
    <virtualType name="CaptureResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\CaptureHandler</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Buckaroo Capture Command - Request Builder -->
    <virtualType name="BuckarooCaptureRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersCaptureDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\InvoiceNumberDataBuilder</item>
                <item name="amountDebit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\AmountInvoicedDataBuilder</item>
                <item name="original_transactio_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\OriginalTransactionKeyDataBuilder</item>
                <item name="order" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\OrderNumberDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\InvoicedArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Buckaroo Refund Command -->
    <virtualType name="BuckarooRefundCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooRefundRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionRefund</argument>
            <argument name="handler" xsi:type="object">RefundResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Refund Command - Request Builder -->
    <virtualType name="BuckarooRefundRequest" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="original_transaction_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\OriginalTransactionKeyDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_credit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountCreditDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersRefundDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Partial Refund Command - Request Builder -->
    <virtualType name="BuckarooPartialRefundRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="original_transaction_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\RefundOriginalTransactionKeyDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_credit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountCreditDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersRefundDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Refund Command - Response Handler -->
    <virtualType name="RefundResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\RefundHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Buckaroo Refund Command -->

    <!-- Buckaroo Cancel Command -->
    <virtualType name="BuckarooCancelCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooCancelRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionCancel</argument>
            <argument name="handler" xsi:type="object">CancelResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Cancel Command - Request Builder -->
    <virtualType name="BuckarooCancelRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="original_transaction_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\OriginalTransactionKeyDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_credit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountCreditDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersCancelDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Cancel Command - Response Handler -->
    <virtualType name="CancelResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\CancelHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Buckaroo Cancel Command -->
    <!-- END Buckaroo Commands infrastructure -->
    <!-- END Buckaroo Payment Provider Gateway -->

    <type name="Magento\Payment\Model\MethodList">
        <arguments>
            <argument name="additionalChecks" xsi:type="array">
                <item name="ip" xsi:type="string">ip</item>
            </argument>
        </arguments>
    </type>

    <type name="Magento\Payment\Model\Checks\SpecificationFactory">
        <arguments>
            <argument name="mapping" xsi:type="array">
                <item name="ip" xsi:type="object">Buckaroo\Magento2\Model\Checks\CanUseForIP</item>
            </argument>
        </arguments>
    </type>


    <!-- Payment Method: iDEAL -->
    <!-- iDEAL Payment Method Facade configuration -->
    <virtualType name="IdealFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Ideal::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">IdealValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">IdealValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">IdealCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- iDEAL Value handlers infrastructure -->
    <virtualType name="IdealValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">IdealConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="IdealConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Ideal</argument>
        </arguments>
    </virtualType>
    <!-- END iDEAL Value handlers infrastructure -->

    <!-- iDEAL validators infrastructure -->
    <virtualType name="IdealValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="global" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\IssuerValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END iDEAL validators infrastructure -->

    <!-- iDEAL Commands infrastructure -->
    <virtualType name="IdealCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">IdealOrderCommand</item>
                <item name="refund" xsi:type="string">IdealRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- iDEAL Order Command -->
    <virtualType name="IdealOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">IdealOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- iDEAL Order Command - Request Builder -->
    <virtualType name="IdealOrderRequest" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order" xsi:type="string">BuckarooOrderRequest</item>
                <item name="payRemainder" xsi:type="string">BuckarooPayRemainderRequest</item>
                <item name="issuer" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\IssuerDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END iDEAL Order Command -->

    <!-- iDEAL Refund Command -->
    <virtualType name="IdealRefundCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooRefundRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionRefund</argument>
            <argument name="handler" xsi:type="object">RefundResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- END iDEAL Refund Command -->
    <!-- END iDEAL Commands infrastructure -->
    <!-- END Payment Method: iDEAL -->


    <!-- Payment Method: Klarna -->
    <!-- Klarna Payment Method Facade configuration -->
    <virtualType name="KlarnaFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarna::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">KlarnaValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">KlarnaValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">KlarnaGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Klarna Value handlers infrastructure -->
    <virtualType name="KlarnaValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">KlarnaConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="KlarnaConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarna</argument>
        </arguments>
    </virtualType>
    <!-- END Klarna Value handlers infrastructure -->

    <!-- Klarna validators infrastructure -->
    <virtualType name="KlarnaValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Klarna validators infrastructure -->

    <!-- Klarna Commands infrastructure -->
    <virtualType name="KlarnaGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">KlarnaOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Klarna Order Command -->
    <virtualType name="KlarnaOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">KlarnaOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Klarna Order Command - Request Builder -->
    <virtualType name="KlarnaOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="customer" xsi:type="string">CustomerKlarnaDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerKlarnaDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="shipping" xsi:type="string">KlarnaBillingDataBuilder</item>
                <item name="billing" xsi:type="string">KlarnaShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="KlarnaBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\KlarnaDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="KlarnaShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">KlarnaShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="KlarnaShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\KlarnaDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>

    <!-- END Klarna Order Command -->
    <!-- END Klarna Commands infrastructure -->
    <!-- END Payment Method: Klarna -->

    <!-- Payment Method: KlarnaIn (Klarna Slice It) -->
    <!-- KlarnaIn Payment Method Facade configuration -->
    <virtualType name="KlarnaInFacade" type="KlarnaFacade">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarnain::CODE</argument>
            <argument name="valueHandlerPool" xsi:type="object">KlarnaInValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">KlarnaInValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">KlarnaInGatewayCommandPool</argument>
        </arguments>
    </virtualType>

    <!-- KlarnaIn Value handlers infrastructure -->
    <virtualType name="KlarnaInValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">KlarnaInConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="KlarnaInConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarnain</argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaIn Value handlers infrastructure -->

    <!-- KlarnaIn validators infrastructure -->
    <virtualType name="KlarnaInValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaIn validators infrastructure -->

    <!-- KlarnaIn Commands infrastructure -->
    <virtualType name="KlarnaInGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">KlarnaInOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- KlarnaIn Order Command -->
    <virtualType name="KlarnaInOrderCommand" type="KlarnaOrderCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">KlarnaInOrderRequest</argument>
            <argument name="client" xsi:type="object">TransactionPayInInstallments</argument>
        </arguments>
    </virtualType>

    <!-- KlarnaIn Order Command - Request Builder -->
    <virtualType name="KlarnaInOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="klarna_order_request" xsi:type="string">KlarnaOrderRequest</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayInInstallmentsDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaIn Order Command -->
    <!-- END KlarnaIn Commands infrastructure -->
    <!-- END Payment Method: KlarnaIn -->

    <!-- Payment Method: KlarnaKp -->
    <!-- KlarnaKp Payment Method Facade configuration -->
    <virtualType name="KlarnaKpFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarnakp::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">KlarnaKpValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">KlarnaKpValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">KlarnaKpGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- KlarnaKp Value handlers infrastructure -->
    <virtualType name="KlarnaKpValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">KlarnaKpConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="KlarnaKpConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Klarnakp</argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaKp Value handlers infrastructure -->

    <!-- KlarnaKp validators infrastructure -->
    <virtualType name="KlarnaKpValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaKp validators infrastructure -->

    <!-- KlarnaKp Commands infrastructure -->
    <virtualType name="KlarnaKpGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="authorize" xsi:type="string">KlarnaKpAuthorizeCommand</item>
                <item name="capture" xsi:type="string">KlarnaKpCaptureCommand</item>
                <item name="cancel" xsi:type="string">KlarnaKpCancelCommand</item>
                <item name="void" xsi:type="string">KlarnaKpCancelCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- KlarnaKp Authorize Command -->
    <virtualType name="KlarnaKpAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">KlarnaKpAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionReserve</argument>
            <argument name="handler" xsi:type="object">AuthorizeResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- KlarnaKp Authorize Command - Request Builder -->
    <virtualType name="KlarnaKpAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="klarnakp_reserve_request" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ReserveDataBuilder</item>
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="customer" xsi:type="string">CustomerKlarnaKpDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersReserveDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- KlarnaKp Capture Command -->
    <virtualType name="KlarnaKpCaptureCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">KlarnaKpCaptureRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">CaptureResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- KlarnaKp Capture Command - Request Builder -->
    <virtualType name="KlarnaKpCaptureRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\InvoiceNumberDataBuilder</item>
                <item name="amountDebit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\AmountInvoicedDataBuilder</item>
                <item name="reservation_number" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ReservationNumberDataBuilder</item>
                <item name="order" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\OrderNumberDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\InvoicedArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaKp Capture Command -->

    <!-- KlarnaKp Cancel Command -->
    <virtualType name="KlarnaKpCancelCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">KlarnaKpCancelRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionCancelReserve</argument>
            <argument name="handler" xsi:type="object">CancelResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- KlarnaKp Cancel Command - Request Builder -->
    <virtualType name="KlarnaKpCancelRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="reservation_number" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ReservationNumberDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaKp Cancel Command -->

    <virtualType name="CustomerKlarnaKpDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="shipping" xsi:type="string">KlarnaKpBillingDataBuilder</item>
                <item name="billing" xsi:type="string">KlarnaKpShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="KlarnaKpBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\KlarnaKpDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="KlarnaKpShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">KlarnaKpShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="KlarnaKpShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\KlarnaKpDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>
    <!-- END KlarnaKp Authorize Command -->
    <!-- END KlarnaKp Commands infrastructure -->
    <!-- END Payment Method: KlarnaKp -->


    <!-- Payment Method: Alipay -->
    <!-- Alipay Payment Method Facade configuration -->
    <virtualType name="AlipayFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Alipay::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">AlipayValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AlipayValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AlipayGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Alipay Value handlers infrastructure -->
    <virtualType name="AlipayValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AlipayConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="AlipayConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Alipay</argument>
        </arguments>
    </virtualType>
    <!-- END Alipay Value handlers infrastructure -->

    <!-- Alipay validators infrastructure -->
    <virtualType name="AlipayValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AlipayCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Alipay</argument>
        </arguments>
    </virtualType>
    <!-- END Alipay validators infrastructure -->

    <!-- Alipay Commands infrastructure -->
    <virtualType name="AlipayGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">AlipayOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Alipay Order Command -->
    <virtualType name="AlipayOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AlipayOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Alipay Order Command - Request Builder -->
    <virtualType name="AlipayOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_debit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountDebitDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="use_mobile_view" xsi:type="string">Buckaroo\Magento2\Gateway\Request\UseMobileViewDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Alipay Order Command -->
    <!-- END Alipay Commands infrastructure -->
    <!-- END Payment Method: Alipay -->


    <!-- Payment Method: Giropay -->
    <!-- Giropay Payment Method Facade configuration -->
    <virtualType name="GiropayFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Giropay::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">GiropayValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">GiropayValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">GiropayGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Giropay Value handlers infrastructure -->
    <virtualType name="GiropayValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">GiropayConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="GiropayConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Giropay</argument>
        </arguments>
    </virtualType>
    <!-- END Giropay Value handlers infrastructure -->

    <!-- Giropay validators infrastructure -->
    <virtualType name="GiropayValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Giropay validators infrastructure -->

    <!-- Giropay Commands infrastructure -->
    <virtualType name="GiropayGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">GiropayOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Giropay Order Command -->
    <virtualType name="GiropayOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">GiropayOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Giropay Order Command - Request Builder -->
    <virtualType name="GiropayOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_debit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountDebitDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Giropay Order Command -->
    <!-- END Giropay Commands infrastructure -->
    <!-- END Payment Method: Giropay -->

    <!-- Payment Method: Trustly -->
    <!-- Trustly Payment Method Facade configuration -->
    <virtualType name="TrustlyFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Trustly::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">TrustlyValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">TrustlyValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">TrustlyGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Trustly Value handlers infrastructure -->
    <virtualType name="TrustlyValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">TrustlyConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="TrustlyConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Trustly</argument>
        </arguments>
    </virtualType>
    <!-- END Trustly Value handlers infrastructure -->

    <!-- Trustly validators infrastructure -->
    <virtualType name="TrustlyValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Trustly validators infrastructure -->

    <!-- Trustly Commands infrastructure -->
    <virtualType name="TrustlyGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">TrustlyOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Trustly Order Command -->
    <virtualType name="TrustlyOrderCommand" type="BuckarooOrderCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">TrustlyOrderRequest</argument>
        </arguments>
    </virtualType>
    <!-- Trustly Order Command - Request Builder -->
    <virtualType name="TrustlyOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\CountryDataBuilder</item>
                <item name="customer_name" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CustomerNameDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Trustly Order Command -->
    <!-- END Trustly Commands infrastructure -->
    <!-- END Payment Method: Trustly -->

    <!-- Payment Method: Przelewy24 -->
    <!-- Przelewy24 Payment Method Facade configuration -->
    <virtualType name="Przelewy24Facade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\P24::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">Przelewy24ValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">Przelewy24ValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">Przelewy24GatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Przelewy24 Value handlers infrastructure -->
    <virtualType name="Przelewy24ValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">Przelewy24ConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="Przelewy24ConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\P24</argument>
        </arguments>
    </virtualType>
    <!-- END Przelewy24 Value handlers infrastructure -->

    <!-- Przelewy24 validators infrastructure -->
    <virtualType name="Przelewy24ValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Przelewy24 validators infrastructure -->

    <!-- Przelewy24 Commands infrastructure -->
    <virtualType name="Przelewy24GatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">Przelewy24OrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Przelewy24 Order Command -->
    <virtualType name="Przelewy24OrderCommand" type="BuckarooOrderCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Przelewy24OrderRequest</argument>
        </arguments>
    </virtualType>
    <!-- Przelewy24 Order Command - Request Builder -->
    <virtualType name="Przelewy24OrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\EmailDataBuilder</item>
                <item name="customer_name" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\CustomerNameDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Przelewy24 Order Command -->
    <!-- END Przelewy24 Commands infrastructure -->
    <!-- END Payment Method: Przelewy24 -->


    <!-- Payment Method: Belfius -->
    <!-- Belfius Payment Method Facade configuration -->
    <virtualType name="BelfiusFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Belfius::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">BelfiusValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">BelfiusValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">BelfiusGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Belfius Value handlers infrastructure -->
    <virtualType name="BelfiusValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">BelfiusConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="BelfiusConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Belfius</argument>
        </arguments>
    </virtualType>
    <!-- END Belfius Value handlers infrastructure -->

    <!-- Belfius validators infrastructure -->
    <virtualType name="BelfiusValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Belfius validators infrastructure -->

    <!-- Belfius Commands infrastructure -->
    <virtualType name="BelfiusGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">BuckarooOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Belfius Commands infrastructure -->
    <!-- END Payment Method: Belfius -->

     <!-- Payment Method: Capayable -->
    <!-- Capayable Payment Method Facade configuration -->
    <virtualType name="CapayableFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\CapayableIn3::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">CapayableValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">CapayableValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">CapayableGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Capayable Value handlers infrastructure -->
    <virtualType name="CapayableValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">CapayableConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="CapayableConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\CapayableIn3</argument>
        </arguments>
    </virtualType>
    <!-- END Capayable Value handlers infrastructure -->

    <!-- Capayable validators infrastructure -->
    <virtualType name="CapayableValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Capayable validators infrastructure -->

    <!-- Capayable Commands infrastructure -->
    <virtualType name="CapayableGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">CapayableOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

     <!-- Capayable Order Command -->
    <virtualType name="CapayableOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CapayableOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPayInInstallments</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Capayable Order Command - Request Builder -->
    <virtualType name="CapayableOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="currency" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\CurrencyDataBuilder</item>
                <item name="amount_debit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\AmountDebitDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\InvoiceDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayInInstallmentsDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\EmailDataBuilder</item>
                <item name="phone" xsi:type="string">CapayablePhone</item>
                <item name="customer_type" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Capayable\Builder\CustomerTypeDataBuilder</item>
                <item name="invoice_date" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Capayable\Builder\InvoiceDateDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Capayable\Builder\ArticlesDataBuilder</item>
                <item name="customer" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Capayable\Builder\CustomerDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Capayable\Builder\AddressDataBuilder</item>
                <item name="sub_totals" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Capayable\Builder\SubTotalsDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CapayablePhone" type="Buckaroo\Magento2\Gateway\Request\Capayable\Builder\PhoneDataBuilder">
        <arguments>
            <argument name="phoneFormatter" xsi:type="object">Buckaroo\Magento2\Service\Formatter\Address\PhoneFormatter</argument>
        </arguments>
    </virtualType>
    <!-- END Capayable Order Command -->
    <!-- END Capayable Commands infrastructure -->
    <!-- END Payment Method: Capayable -->

    <!-- Payment Method: Eps -->
    <!-- Eps Payment Method Facade configuration -->
    <virtualType name="EpsFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Eps::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">EpsValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">EpsValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">BuckarooGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Eps Value handlers infrastructure -->
    <virtualType name="EpsValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">EpsConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="EpsConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Eps</argument>
        </arguments>
    </virtualType>
    <!-- END Eps Value handlers infrastructure -->

    <!-- Eps validators infrastructure -->
    <virtualType name="EpsValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Eps validators infrastructure -->
    <!-- END Eps Commands infrastructure -->
    <!-- END Payment Method: Eps -->

    <!-- Payment Method: Kbc -->
    <!-- Kbc Payment Method Facade configuration -->
    <virtualType name="KbcFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Kbc::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">KbcValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">KbcValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">BuckarooGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Kbc Value handlers infrastructure -->
    <virtualType name="KbcValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">KbcConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="KbcConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Kbc</argument>
        </arguments>
    </virtualType>
    <!-- END Kbc Value handlers infrastructure -->

    <!-- Kbc validators infrastructure -->
    <virtualType name="KbcValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Kbc validators infrastructure -->

    <!-- END Kbc Commands infrastructure -->
    <!-- END Payment Method: Kbc -->


    <!-- Payment Method: Bancontact - Mrcash-->
    <!-- Mrcash Payment Method Facade configuration -->
    <virtualType name="MrcashFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Mrcash::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">MrcashValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">MrcashValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">MrcashGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Mrcash Value handlers infrastructure -->
    <virtualType name="MrcashValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">MrcashConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="MrcashConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Mrcash</argument>
        </arguments>
    </virtualType>
    <!-- END Mrcash Value handlers infrastructure -->

    <!-- Mrcash validators infrastructure -->
    <virtualType name="MrcashValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Mrcash validators infrastructure -->

    <!-- Mrcash Commands infrastructure -->
    <virtualType name="MrcashGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">MrcashOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Mrcash Order Command -->
    <virtualType name="MrcashOrderCommand" type="BuckarooOrderCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">MrcashOrderRequest</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
        </arguments>
    </virtualType>
    <!-- Mrcash Order Command - Request Builder -->
    <virtualType name="MrcashOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="token_encrypted_data" xsi:type="string">Buckaroo\Magento2\Gateway\Request\TokenEncryptedDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Mrcash Order Command -->
    <!-- END Mrcash Commands infrastructure -->
    <!-- END Payment Method: Bancontact - Mrcash -->

    <!-- Payment Method: Payconiq -->
    <!-- Payconiq Payment Method Facade configuration -->
    <virtualType name="PayconiqFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Payconiq::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">PayconiqValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">PayconiqValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">BuckarooGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Payconiq Value handlers infrastructure -->
    <virtualType name="PayconiqValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">PayconiqConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="PayconiqConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Payconiq</argument>
        </arguments>
    </virtualType>
    <!-- END Payconiq Value handlers infrastructure -->

    <!-- Payconiq validators infrastructure -->
    <virtualType name="PayconiqValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Payconiq validators infrastructure -->
    <!-- END Payconiq Commands infrastructure -->
    <!-- END Payment Method: Payconiq -->

    <!-- Payment Method: Billink -->
    <!-- Billink Payment Method Facade configuration -->
    <virtualType name="BillinkFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Billink::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">BillinkValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">BillinkValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">BillinkGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Billink Value handlers infrastructure -->
    <virtualType name="BillinkValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">BillinkConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="BillinkConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Billink</argument>
        </arguments>
    </virtualType>
    <!-- END Billink Value handlers infrastructure -->

    <!-- Billink validators infrastructure -->
    <virtualType name="BillinkValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Billink validators infrastructure -->

    <!-- Billink Commands infrastructure -->
    <virtualType name="BillinkGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">BillinkOrderCommand</item>
                <item name="authorize" xsi:type="string">BillinkAuthorizeCommand</item>
                <item name="capture" xsi:type="string">BuckarooCaptureCommand</item>
                <item name="cancel" xsi:type="string">BuckarooCancelCommand</item>
                <item name="void" xsi:type="string">BuckarooCancelCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Billink Order Command -->
    <virtualType name="BillinkOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BillinkOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Billink Order Command - Request Builder -->
    <virtualType name="BillinkOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="vat_number" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\VATNumberDataBuilder</item>
                <item name="customer" xsi:type="string">CustomerBillinkDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerBillinkDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="billing" xsi:type="string">BillinkBillingDataBuilder</item>
                <item name="shipping" xsi:type="string">BillinkShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="BillinkBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\BillinkDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="BillinkShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">BillinkShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="BillinkShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\BillinkDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>

    <virtualType name="PhoneShippingDataBuilder" type="Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>

    <virtualType name="EmailAddressShippingDataBuilder" type="Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>
    <!-- END Billink Order Command -->

    <!-- Billink Authorize Command -->
    <virtualType name="BillinkAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BillinkAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionAuthorize</argument>
            <argument name="handler" xsi:type="object">AuthorizeResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Billink Authorize Command - Request Builder -->
    <virtualType name="BillinkAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BillinkOrderRequest</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersAuthorizeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Billink Authorize Command -->

    <!-- Billink Capture Command -->
    <virtualType name="BillinkCaptureCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooCaptureRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionCapture</argument>
            <argument name="handler" xsi:type="object">CaptureResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- END Billink Capture Command -->
    <!-- END Billink Commands infrastructure -->
    <!-- END Payment Method: Billink -->

    <!-- Payment Method: Afterpay -->
    <!-- Afterpay Payment Method Facade configuration -->
    <virtualType name="AfterpayFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay20::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">AfterpayValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AfterpayValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AfterpayGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Afterpay Value handlers infrastructure -->
    <virtualType name="AfterpayValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AfterpayConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="AfterpayConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay20</argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Value handlers infrastructure -->

    <!-- Afterpay validators infrastructure -->
    <virtualType name="AfterpayValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay validators infrastructure -->

    <!-- Afterpay Commands infrastructure -->
    <virtualType name="AfterpayGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">AfterpayOrderCommand</item>
                <item name="authorize" xsi:type="string">AfterpayAuthorizeCommand</item>
                <item name="capture" xsi:type="string">BuckarooCaptureCommand</item>
                <item name="cancel" xsi:type="string">BuckarooCancelCommand</item>
                <item name="void" xsi:type="string">BuckarooCancelCommand</item>
                <item name="refund" xsi:type="string">AfterpayRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Afterpay Order Command -->
    <virtualType name="AfterpayOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Afterpay Order Command - Request Builder -->
    <virtualType name="AfterpayOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="customer" xsi:type="string">CustomerAfterpayDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerAfterpayDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="billing" xsi:type="string">AfterpayBillingDataBuilder</item>
                <item name="shipping" xsi:type="string">AfterpayShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AfterpayBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\AfterpayDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AfterpayShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">AfterpayShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AfterpayShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\AfterpayDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>

    <virtualType name="PhoneShippingDataBuilder" type="Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>

    <virtualType name="EmailAddressShippingDataBuilder" type="Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Order Command -->

    <!-- Afterpay Authorize Command -->
    <virtualType name="AfterpayAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionAuthorize</argument>
            <argument name="handler" xsi:type="object">AuthorizeResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Afterpay Authorize Command - Request Builder -->
    <virtualType name="AfterpayAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">AfterpayOrderRequest</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersAuthorizeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Authorize Command -->

    <!-- Afterpay Refund Command -->
    <virtualType name="AfterpayRefundCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayRefundRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionRefund</argument>
            <argument name="handler" xsi:type="object">RefundResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Afterpay Refund Command - Request Builder -->
    <virtualType name="AfterpayRefundRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="refund_request" xsi:type="string">BuckarooPartialRefundRequest</item>
                <item name="creditmemmo_articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\CreditmemoArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Refund Command -->
    <!-- END Afterpay Commands infrastructure -->
    <!-- END Payment Method: Afterpay -->

    <!-- Payment Method: Afterpay Old -->
    <!-- Afterpay Old Payment Method Facade configuration -->
    <virtualType name="AfterpayOldFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">AfterpayOldValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AfterpayOldValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AfterpayOldGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Afterpay Old Value handlers infrastructure -->
    <virtualType name="AfterpayOldValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AfterpayOldConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="AfterpayOldConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Afterpay</argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Old Value handlers infrastructure -->

    <!-- Afterpay Old validators infrastructure -->
    <virtualType name="AfterpayOldValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Old validators infrastructure -->

    <!-- Afterpay Old Commands infrastructure -->
    <virtualType name="AfterpayOldGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">AfterpayOldOrderCommand</item>
                <item name="authorize" xsi:type="string">AfterpayOldAuthorizeCommand</item>
                <item name="capture" xsi:type="string">AfterpayOldCaptureCommand</item>
                <item name="cancel" xsi:type="string">BuckarooCancelCommand</item>
                <item name="void" xsi:type="string">BuckarooCancelCommand</item>
                <item name="refund" xsi:type="string">AfterpayOldRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Afterpay Old Order Command -->
    <virtualType name="AfterpayOldOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayOldOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Afterpay Old Order Command - Request Builder -->
    <virtualType name="AfterpayOldOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="afterpayold" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AfterpayOldDataBuilder</item>
                <item name="customer" xsi:type="string">CustomerAfterpayOldDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerAfterpayOldDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="billing" xsi:type="string">AfterpayOldBillingDataBuilder</item>
                <item name="shipping" xsi:type="string">AfterpayOldShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AfterpayOldBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\AfterpayOldDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AfterpayOldShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">AfterpayOldShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AfterpayOldShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\AfterpayOldDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Old Order Command -->

    <!-- Afterpay Old Authorize Command -->
    <virtualType name="AfterpayOldAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayOldAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionAuthorize</argument>
            <argument name="handler" xsi:type="object">AuthorizeResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Afterpay Old Authorize Command - Request Builder -->
    <virtualType name="AfterpayOldAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">AfterpayOldOrderRequest</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersAuthorizeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Old Authorize Command -->

    <!-- Afterpay Old Capture Command -->
    <virtualType name="AfterpayOldCaptureCommand" type="BuckarooCaptureCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayOldCaptureRequest</argument>
        </arguments>
    </virtualType>
    <!-- Afterpay Old Capture Command - Request Builder -->
    <virtualType name="AfterpayOldCaptureRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="capture_request" xsi:type="string">BuckarooCaptureRequest</item>
                <item name="afterpayold" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AfterpayOldDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Old Authorize Command -->

    <!-- Afterpay Old Refund Command -->
    <virtualType name="AfterpayOldRefundCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AfterpayOldRefundRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionRefund</argument>
            <argument name="handler" xsi:type="object">RefundResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Afterpay Old Refund Command - Request Builder -->
    <virtualType name="AfterpayOldRefundRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="refund_request" xsi:type="string">BuckarooPartialRefundRequest</item>
                <item name="creditmemmo_articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\CreditmemoArticlesDataBuilder</item>
                <item name="afterpayold" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AfterpayOldDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Afterpay Old Refund Command -->
    <!-- END Afterpay Old Commands infrastructure -->
    <!-- END Payment Method: Afterpay Old -->

    <!-- Payment Method: Tinka -->
    <!-- Tinka Payment Method Facade configuration -->
    <virtualType name="TinkaFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Tinka::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">TinkaValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">TinkaValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">TinkaGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Tinka Value handlers infrastructure -->
    <virtualType name="TinkaValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">TinkaConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="TinkaConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Tinka</argument>
        </arguments>
    </virtualType>
    <!-- END Tinka Value handlers infrastructure -->

    <!-- Tinka validators infrastructure -->
    <virtualType name="TinkaValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Tinka validators infrastructure -->

    <!-- Tinka Commands infrastructure -->
    <virtualType name="TinkaGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">TinkaOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Tinka Order Command -->
    <virtualType name="TinkaOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">TinkaOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Tinka Order Command - Request Builder -->
    <virtualType name="TinkaOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="tinka" xsi:type="string">Buckaroo\Magento2\Gateway\Request\TinkaDataBuilder</item>
                <item name="customer" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\CustomerDataBuilder</item>
                <item name="customer_address" xsi:type="string">CustomerTinkaDataBuilder</item>
                <item name="articles" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Articles\ArticlesDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerTinkaDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="billing" xsi:type="string">TinkaBillingDataBuilder</item>
                <item name="shipping" xsi:type="string">TinkaShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TinkaBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\TinkaDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TinkaShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">TinkaShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="TinkaShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\TinkaDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>
    <!-- END Tinka Order Command -->
    <!-- END Tinka Commands infrastructure -->
    <!-- END Payment Method: Tinka -->

    <!-- Payment Method: CreditClick-->
    <!-- CreditClick Payment Method Facade configuration -->
    <virtualType name="CreditClickFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\CreditClick::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">CreditClickValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">CreditClickValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">CreditClickGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- CreditClick Value handlers infrastructure -->
    <virtualType name="CreditClickValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">CreditClickConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="CreditClickConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\CreditClick</argument>
        </arguments>
    </virtualType>
    <!-- END CreditClick Value handlers infrastructure -->

    <!-- CreditClick validators infrastructure -->
    <virtualType name="CreditClickValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditClick validators infrastructure -->

    <!-- CreditClick Commands infrastructure -->
    <virtualType name="CreditClickGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">CreditClickOrderCommand</item>
                <item name="refund" xsi:type="string">CreditClickRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- CreditClick Order Command -->
    <virtualType name="CreditClickOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditClickOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- CreditClick Order Command - Request Builder -->
    <virtualType name="CreditClickOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
                <item name="customer_name" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\CustomerNameDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditClick Order Command -->

     <!-- CreditClick Refund Command -->
    <virtualType name="CreditClickRefundCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditClickRefundRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionRefund</argument>
            <argument name="handler" xsi:type="object">RefundResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- CreditClick Refund Command - Request Builder -->
    <virtualType name="CreditClickRefundRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="refund_request" xsi:type="string">BuckarooRefundRequest</item>
                <item name="refund_reason" xsi:type="string">Buckaroo\Magento2\Gateway\Request\RefundReasonDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditClick Order Command -->
    <!-- END CreditClick Commands infrastructure -->
    <!-- END Payment Method: CreditClick -->

    <!-- Payment Method: Applepay-->
    <!-- Applepay Payment Method Facade configuration -->
    <virtualType name="ApplepayFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Applepay::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">ApplepayValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">ApplepayValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">ApplepayGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Applepay Value handlers infrastructure -->
    <virtualType name="ApplepayValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">ApplepayConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="ApplepayConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Applepay</argument>
        </arguments>
    </virtualType>
    <!-- END Applepay Value handlers infrastructure -->

    <!-- Applepay validators infrastructure -->
    <virtualType name="ApplepayValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Applepay validators infrastructure -->

    <!-- Applepay Commands infrastructure -->
    <virtualType name="ApplepayGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">ApplepayOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Applepay Order Command -->
    <virtualType name="ApplepayOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">ApplepayOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Applepay Order Command - Request Builder -->
    <virtualType name="ApplepayOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="applepay" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\ApplepayDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Applepay Order Command -->

    <!-- END Applepay Commands infrastructure -->
    <!-- END Payment Method: Applepay -->

    <!-- Payment Method: Emandate-->
    <!-- Emandate Payment Method Facade configuration -->
    <virtualType name="EmandateFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Emandate::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">EmandateValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">EmandateValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">EmandateGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Emandate Value handlers infrastructure -->
    <virtualType name="EmandateValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">EmandateConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="EmandateConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Emandate
            </argument>
        </arguments>
    </virtualType>
    <!-- END Emandate Value handlers infrastructure -->

    <!-- Emandate validators infrastructure -->
    <virtualType name="EmandateValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="global" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\IssuerValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Emandate validators infrastructure -->

    <!-- Emandate Commands infrastructure -->
    <virtualType name="EmandateGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">EmandateOrderCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Emandate Order Command -->
    <virtualType name="EmandateOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">EmandateOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionCreateMandate</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator
            </argument>
            <argument name="errorMessageMapper" xsi:type="object">
                Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Emandate Order Command - Request Builder -->
    <virtualType name="EmandateOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersCreateMandateDataBuilder</item>
                <item name="emandate" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmandateDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>


    <type name="Buckaroo\Magento2\Gateway\Request\EmandateDataBuilder">
        <arguments>
             <argument name="config" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Emandate</argument>
        </arguments>
    </type>
    <!-- END Emandate Order Command -->

    <!-- END Emandate Commands infrastructure -->
    <!-- END Payment Method: Emandate -->

    <!-- Payment Method: Giftcards -->
    <type name="Buckaroo\Magento2\Model\Giftcard\Request\Giftcard">
        <arguments>
            <argument name="clientInterface" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
        </arguments>
    </type>
    <!-- Giftcards Payment Method Facade configuration -->
    <virtualType name="GiftcardsFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Giftcards::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">GiftcardsValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">GiftcardsValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">GiftcardsGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Giftcards Value handlers infrastructure -->
    <virtualType name="GiftcardsValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">GiftcardsConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="GiftcardsConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Giftcards</argument>
        </arguments>
    </virtualType>
    <!-- END Giftcards Value handlers infrastructure -->

    <!-- Giftcards validators infrastructure -->
    <virtualType name="GiftcardsValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="availability" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\AllowedGiftcardsValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Giftcards validators infrastructure -->

    <!-- Giftcards Commands infrastructure -->
    <virtualType name="GiftcardsGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">GiftcardsOrderCommand</item>
                <item name="refund" xsi:type="string">GiftcardsRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Giftcards Order Command -->
    <virtualType name="GiftcardsOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">GiftcardsOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPayRedirect</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Giftcards Order Command - Request Builder -->
    <virtualType name="GiftcardsOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="payRemainder" xsi:type="string">BuckarooPayRemainderRequest</item>
                <item name="giftcards" xsi:type="string">Buckaroo\Magento2\Gateway\Request\GiftcardsDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Giftcards Order Command -->

    <!-- Giftcards Refund Command -->
    <virtualType name="GiftcardsRefundCommand" type="BuckarooRefundCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">GiftcardsRefundRequest</argument>
        </arguments>
    </virtualType>

    <!-- Giftcards Refund Command - Request Builder -->
    <virtualType name="GiftcardsRefundRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooRefundRequest</item>
                <item name="giftcard_name" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\GiftcardNameDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Giftcards Refund Command -->
    <!-- END Giftcards Commands infrastructure -->
    <!-- END Payment Method: Giftcards -->

    <!-- Payment Method: PayPerEmail -->
    <!-- PayPerEmail Payment Method Facade configuration -->
    <virtualType name="PayPerEmailFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\PayPerEmail::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">PayPerEmailValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">PayPerEmailValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">PayPerEmailGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- PayPerEmail Value handlers infrastructure -->
    <virtualType name="PayPerEmailValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">PayPerEmailConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="PayPerEmailConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\PayPerEmail</argument>
        </arguments>
    </virtualType>
    <!-- END PayPerEmail Value handlers infrastructure -->

    <!-- PayPerEmail validators infrastructure -->
    <virtualType name="PayPerEmailValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="availability" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\AreaCodeValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END PayPerEmail validators infrastructure -->

    <!-- PayPerEmail Commands infrastructure -->
    <virtualType name="PayPerEmailGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">PayPerEmailOrderCommand</item>
                <item name="paylink" xsi:type="string">PayLinkCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- PayPerEmail Order Command -->
    <virtualType name="PayPerEmailOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">PayPerEmailOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPaymentInvitation</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- PayPerEmail Order Command - Request Builder -->
    <virtualType name="PayPerEmailOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="payPerEmail" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PayPerEmailDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayPerEmailDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END PayPerEmail Order Command -->
    <!-- PayPerEmail PayLink Command -->
    <virtualType name="PayLinkCommand" type="PayPerEmailOrderCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">PayLinkRequest</argument>
            <argument name="handler" xsi:type="object">PayLinkResponseHandler</argument>
        </arguments>
    </virtualType>
    <!-- PayPerEmail PayLink Command - Request Builder -->
    <virtualType name="PayLinkRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="payPerEmail" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PayLinkDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersPayPerEmailDataBuilder</item>
                <item name="additional_parameters2" xsi:type="string">AdditionalParametersPayLinkDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Buckaroo Order Command - Response Handler -->
    <virtualType name="PayLinkResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\OrderHandler</item>
                <item name="paylink" xsi:type="string">Buckaroo\Magento2\Gateway\Response\PayLinkHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END PayPerEmail PayLink Command -->

    <!-- END PayPerEmail Commands infrastructure -->
    <!-- END Payment Method: PayPerEmail -->

    <!-- Payment Method: Transfer-->
    <!-- Transfer Payment Method Facade configuration -->
    <virtualType name="TransferFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Transfer::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">TransferValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">TransferValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">TransferGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Transfer Value handlers infrastructure -->
    <virtualType name="TransferValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">TransferConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="TransferConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Transfer
            </argument>
        </arguments>
    </virtualType>
    <!-- END Transfer Value handlers infrastructure -->

    <!-- Transfer validators infrastructure -->
    <virtualType name="TransferValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Transfer validators infrastructure -->

    <!-- Transfer Commands infrastructure -->
    <virtualType name="TransferGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">TransferOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundWithCreditManagementCommand</item>
                <item name="void" xsi:type="string">BuckarooVoidCreditManagementCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Transfer Order Command -->
    <virtualType name="TransferOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">TransferOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderWithCreditManagementResponseHandler</argument>
            <argument name="validator" xsi:type="object">
                Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator
            </argument>
            <argument name="errorMessageMapper" xsi:type="object">
                Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper
            </argument>
        </arguments>
    </virtualType>

    <!-- Transfer Order Command - Request Builder -->
    <virtualType name="TransferOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
                <item name="customer_name" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\CustomerNameDataBuilder</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\CountryDataBuilder</item>
                <item name="transfer_config_params" xsi:type="string">Buckaroo\Magento2\Gateway\Request\TransferOrderDataBuilder</item>
                <item name="credit_management" xsi:type="string">BuckarooDefaultCreditManagment</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Transfer Order Command -->

    <!-- END Transfer Commands infrastructure -->
    <!-- END Payment Method: Transfer -->

      <!-- Payment Method: Voucher -->
    <!-- Voucher Payment Method Facade configuration -->
    <virtualType name="VoucherFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Voucher::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">VoucherValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">VoucherValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">VoucherGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>
    <!-- Voucher Value handlers infrastructure -->
    <virtualType name="VoucherValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">VoucherConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="VoucherConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Voucher</argument>
        </arguments>
    </virtualType>
    <!-- END Voucher Value handlers infrastructure -->

    <!-- Voucher validators infrastructure -->
    <virtualType name="VoucherValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Voucher validators infrastructure -->

    <!-- Voucher Commands infrastructure -->
    <virtualType name="VoucherGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">BuckarooOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

   <type name="Buckaroo\Magento2\Model\Voucher\ApplyVoucherRequest">
        <arguments>
            <argument name="clientInterface" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
        </arguments>
    </type>
    <!-- END Voucher Commands infrastructure -->
    <!-- END Payment Method: Voucher -->

    <!-- Credit Managment -->
    <!-- Buckaroo Order Command - Response Handler -->
    <virtualType name="OrderWithCreditManagementResponseHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\OrderHandler</item>
                <item name="credit_management" xsi:type="string">Buckaroo\Magento2\Gateway\Response\CreditManagementOrderHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Buckaroo Order Command -->


    <!-- Buckaroo Refund Command -->
    <virtualType name="BuckarooVoidCreditManagementCommand" type="BuckarooRefundCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooVoidCreditManagementRequest</argument>
        </arguments>
    </virtualType>

    <virtualType name="BuckarooVoidCreditManagementRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="credit_management" xsi:type="string">BuckarooDefaultVoidCreditManagment</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="BuckarooDefaultVoidCreditManagment" type="BuckarooDefaultRefundCreditManagment">
        <arguments>
            <argument name="type" xsi:type="const">Buckaroo\Magento2\Gateway\Request\CreditManagement\BuilderComposite::TYPE_VOID</argument>
        </arguments>
    </virtualType>
    <!-- End Buckaroo Refund Command -->


    <!-- Buckaroo Refund Command -->
    <virtualType name="BuckarooRefundWithCreditManagementCommand" type="BuckarooRefundCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">BuckarooRefundWithCreditManagementRequest</argument>
            <argument name="client" xsi:type="object">TransactionRefund</argument>
        </arguments>
    </virtualType>

    <virtualType name="BuckarooRefundWithCreditManagementRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="refund_request" xsi:type="string">BuckarooRefundRequest</item>
                <item name="credit_management" xsi:type="string">BuckarooDefaultRefundCreditManagment</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="BuckarooDefaultRefundCreditManagment" type="Buckaroo\Magento2\Gateway\Request\CreditManagement\BuilderComposite">
        <arguments>
            <argument name="type" xsi:type="const">Buckaroo\Magento2\Gateway\Request\CreditManagement\BuilderComposite::TYPE_REFUND</argument>
            <argument name="builders" xsi:type="array">
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\InvoiceDataBuilder</item>
                <item name="invoice_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\InvoiceKeyDataBuilder</item>
                <item name="invoice_number" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\InvoiceNumberDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- End Buckaroo Refund Command -->

    <virtualType name="BuckarooDefaultCreditManagment" type="Buckaroo\Magento2\Gateway\Request\CreditManagement\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="group" xsi:type="string">BuckarooCreditManagmentGroup</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
                <item name="config" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\ConfigDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\InvoiceDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="BuckarooCreditManagmentGroup" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="person" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\PersonDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\AddressDataBuilder</item>
                <item name="company" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\CompanyDataBuilder</item>
                <item name="debtor" xsi:type="string">Buckaroo\Magento2\Gateway\Request\CreditManagement\DebtorDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- END Credit Managment -->

    <type name="Buckaroo\Magento2\Observer\VoidCm3Payment">
        <arguments>
            <argument name="voidCommand" xsi:type="object">BuckarooVoidCreditManagementCommand</argument>
        </arguments>
    </type>

    <!-- Payment Method: Rtp -->
    <!-- Rtp Payment Method Facade configuration -->
    <virtualType name="RtpFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Rtp::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">RtpValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">RtpValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">RtpGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Rtp Value handlers infrastructure -->
    <virtualType name="RtpValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">RtpConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="RtpConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Rtp</argument>
        </arguments>
    </virtualType>
    <!-- END Rtp Value handlers infrastructure -->

    <!-- Rtp validators infrastructure -->
    <virtualType name="RtpValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Rtp validators infrastructure -->

    <!-- Rtp Commands infrastructure -->
    <virtualType name="RtpGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">RtpOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Rtp Order Command -->
    <virtualType name="RtpOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">RtpOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Rtp Order Command - Request Builder -->
    <virtualType name="RtpOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="name" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\NameDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Rtp Order Command -->
    <!-- END Rtp Commands infrastructure -->
    <!-- END Payment Method: Rtp -->

    <!-- Payment Method: Sofortbanking -->
    <!-- Sofortbanking Payment Method Facade configuration -->
    <virtualType name="SofortbankingFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Sofortbanking::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">SofortbankingValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">SofortbankingValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">SofortbankingGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Sofortbanking Value handlers infrastructure -->
    <virtualType name="SofortbankingValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">SofortbankingConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="SofortbankingConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Sofortbanking</argument>
        </arguments>
    </virtualType>
    <!-- END Sofortbanking Value handlers infrastructure -->

    <!-- Sofortbanking validators infrastructure -->
    <virtualType name="SofortbankingValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Sofortbanking validators infrastructure -->

    <!-- Sofortbanking Commands infrastructure -->
    <virtualType name="SofortbankingGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">BuckarooOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- END Sofortbanking Order Command -->
    <!-- END Sofortbanking Commands infrastructure -->
    <!-- END Payment Method: Sofortbanking -->

    <!-- Payment Method: Paypal -->
    <!-- Paypal Payment Method Facade configuration -->
    <virtualType name="PaypalFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Paypal::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">PaypalValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">PaypalValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">PaypalGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>
    <!-- Paypal Value handlers infrastructure -->
    <virtualType name="PaypalValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">PaypalConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="PaypalConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Paypal
            </argument>
        </arguments>
    </virtualType>
    <!-- END Paypal Value handlers infrastructure -->

    <!-- Paypal validators infrastructure -->
    <virtualType name="PaypalValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Paypal validators infrastructure -->

    <!-- Paypal Commands infrastructure -->
    <virtualType name="PaypalGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">PaypalOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundWithCreditManagementCommand</item>
                <item name="void" xsi:type="string">BuckarooVoidCreditManagementCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Paypal Order Command -->
    <virtualType name="PaypalOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">PaypalOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
            <argument name="handler" xsi:type="object">OrderWithCreditManagementResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Paypal Order Command - Request Builder -->
    <virtualType name="PaypalOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="expressOrderId" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\ExpressOrderIdDataBuilder</item>
                <item name="paypal_extrainfo" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PaypalExtrainfoDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Paypal Order Command -->

    <!-- END Paypal Commands infrastructure -->
    <!-- END Payment Method: Paypal -->

    <!-- Payment Method: Creditcard -->
    <!-- Creditcard Payment Method Facade configuration -->
    <virtualType name="CreditcardFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcard::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info\Creditcard</argument>
            <argument name="valueHandlerPool" xsi:type="object">CreditcardValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">CreditcardValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">CreditcardGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Creditcard Value handlers infrastructure -->
    <virtualType name="CreditcardValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">CreditcardConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="CreditcardConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcard</argument>
        </arguments>
    </virtualType>
    <!-- END Creditcard Value handlers infrastructure -->

    <!-- Creditcard validators infrastructure -->
    <virtualType name="CreditcardValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Creditcard validators infrastructure -->

    <!-- Creditcard Commands infrastructure -->
    <virtualType name="CreditcardGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">CreditcardOrderCommand</item>
                <item name="authorize" xsi:type="string">CreditcardAuthorizeCommand</item>
                <item name="capture" xsi:type="string">CreditcardCaptureCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Creditcard Order Command -->
    <virtualType name="CreditcardOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditcardOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainder</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Creditcard Order Command - Request Builder -->
    <virtualType name="CreditcardOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="creditcard_type" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\CreditcardTypeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Creditcard Order Command -->

    <!-- Creditcard Authorize Command -->
    <virtualType name="CreditcardAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditcardAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionAuthorize</argument>
            <argument name="handler" xsi:type="object">AuthorizeResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- Creditcard Authorize Command - Request Builder -->
    <virtualType name="CreditcardAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">CreditcardOrderRequest</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersAuthorizeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Creditcard Authorize Command -->

    <!-- Creditcard Capture Command -->
    <virtualType name="CreditcardCaptureCommand" type="BuckarooCaptureCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditcardCaptureRequest</argument>
        </arguments>
    </virtualType>
    <!-- Creditcard Capture Command - Request Builder -->
    <virtualType name="CreditcardCaptureRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\InvoiceNumberDataBuilder</item>
                <item name="order" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\OrderNumberDataBuilder</item>
                <item name="amountDebit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\AmountInvoicedDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="original_transactio_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\OriginalTransactionKeyDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersCaptureDataBuilder</item>
                <item name="creditcard_type" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\CreditcardTypeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Creditcard Capture Command -->
    <!-- END Creditcard Commands infrastructure -->
    <!-- END Payment Method: Creditcard -->

    <!-- Payment Method: CreditcardEncrypted -->
    <!-- CreditcardEncrypted Payment Method Facade configuration -->
    <virtualType name="CreditcardEncryptedFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcards::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">CreditcardEncryptedValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">CreditcardEncryptedValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">CreditcardEncryptedGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- CreditcardEncrypted Value handlers infrastructure -->
    <virtualType name="CreditcardEncryptedValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">CreditcardEncryptedConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="CreditcardEncryptedConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Creditcards</argument>
        </arguments>
    </virtualType>
    <!-- END CreditcardEncrypted Value handlers infrastructure -->

    <!-- CreditcardEncrypted validators infrastructure -->
    <virtualType name="CreditcardEncryptedValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditcardEncrypted validators infrastructure -->

    <!-- CreditcardEncrypted Commands infrastructure -->
    <virtualType name="CreditcardEncryptedGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">CreditcardEncryptedOrderCommand</item>
                <item name="authorize" xsi:type="string">CreditcardEncryptedAuthorizeCommand</item>
                <item name="capture" xsi:type="string">CreditcardEncryptedCaptureCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- CreditcardEncrypted Order Command -->
    <virtualType name="CreditcardEncryptedOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditcardEncryptedOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">Buckaroo\Magento2\Gateway\Http\Client\TransactionPayRemainderEncrypted</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- CreditcardEncrypted Order Command - Request Builder -->
    <virtualType name="CreditcardEncryptedOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="creditcard_encrypted" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\CreditcardEncryptedDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditcardEncrypted Order Command -->

    <!-- CreditcardEncrypted Authorize Command -->
    <virtualType name="CreditcardEncryptedAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditcardEncryptedAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionAuthorizeEncrypted</argument>
            <argument name="handler" xsi:type="object">AuthorizeResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>
    <!-- CreditcardEncrypted Authorize Command - Request Builder -->
    <virtualType name="CreditcardEncryptedAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">CreditcardEncryptedOrderRequest</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersAuthorizeDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditcardEncrypted Authorize Command -->

    <!-- CreditcardEncrypted Capture Command -->
    <virtualType name="CreditcardEncryptedCaptureCommand" type="BuckarooCaptureCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">CreditcardEncryptedCaptureRequest</argument>
        </arguments>
    </virtualType>
    <!-- CreditcardEncrypted Capture Command - Request Builder -->
    <virtualType name="CreditcardEncryptedCaptureRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="method" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\PaymentMethodDataBuilder</item>
                <item name="invoice" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\InvoiceNumberDataBuilder</item>
                <item name="order" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\OrderNumberDataBuilder</item>
                <item name="amountDebit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\AmountInvoicedDataBuilder</item>
                <item name="description" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\DescriptionDataBuilder</item>
                <item name="client_ip" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ClientIPDataBuilder</item>
                <item name="return_url" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BasicParameter\ReturnUrlDataBuilder</item>
                <item name="original_transactio_key" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Invoice\OriginalTransactionKeyDataBuilder</item>
                <item name="additional_parameters" xsi:type="string">AdditionalParametersCaptureDataBuilder</item>
                <item name="creditcard_type" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\CreditcardEncryptedDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END CreditcardEncrypted Capture Command -->
    <!-- END CreditcardEncrypted Commands infrastructure -->
    <!-- END Payment Method: CreditcardEncrypted -->


    <!-- Payment Method: Pospayment -->
    <!-- Pospayment Payment Method Facade configuration -->
    <virtualType name="PospaymentFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Pospayment::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">PospaymentValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">PospaymentValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">PospaymentGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Pospayment Value handlers infrastructure -->
    <virtualType name="PospaymentValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">PospaymentConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="PospaymentConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Pospayment</argument>
        </arguments>
    </virtualType>
    <!-- END Pospayment Value handlers infrastructure -->

    <!-- Pospayment validators infrastructure -->
    <virtualType name="PospaymentValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="availability" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\PosPaymentValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Pospayment validators infrastructure -->

    <!-- Pospayment Commands infrastructure -->
    <virtualType name="PospaymentGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">PospaymentOrderCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Pospayment Order Command -->
    <virtualType name="PospaymentOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">PospaymentOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Pospayment Order Command - Request Builder -->
    <virtualType name="PospaymentOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="terminalId" xsi:type="string">Buckaroo\Magento2\Gateway\Request\TerminalIdDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Pospayment Order Command -->
    <!-- END Pospayment Commands infrastructure -->
    <!-- END Payment Method: Pospayment -->

    <!-- Payment Method: SepaDirectDebit -->
    <!-- SepaDirectDebit Payment Method Facade configuration -->
    <virtualType name="SepaDirectDebitFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\SepaDirectDebit::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">SepaDirectDebitValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">SepaDirectDebitValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">SepaDirectDebitGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">false</argument>
        </arguments>
    </virtualType>

    <!-- SepaDirectDebit Value handlers infrastructure -->
    <virtualType name="SepaDirectDebitValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">SepaDirectDebitConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="SepaDirectDebitConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\SepaDirectDebit</argument>
        </arguments>
    </virtualType>
    <!-- END SepaDirectDebit Value handlers infrastructure -->

    <!-- SepaDirectDebit validators infrastructure -->
    <virtualType name="SepaDirectDebitValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
                <item name="bankAccount" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\BankAccountValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END SepaDirectDebit validators infrastructure -->

    <!-- SepaDirectDebit Commands infrastructure -->
    <virtualType name="SepaDirectDebitGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">SepaDirectDebitOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundWithCreditManagementCommand</item>
                <item name="void" xsi:type="string">BuckarooVoidCreditManagementCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- SepaDirectDebit Order Command -->
    <virtualType name="SepaDirectDebitOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">SepaDirectDebitOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">SepaDirectDebitHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- SepaDirectDebit Order Command - Request Builder -->
    <virtualType name="SepaDirectDebitOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="orderRequest" xsi:type="string">BuckarooOrderRequest</item>
                <item name="sepaDirectDebit" xsi:type="string">Buckaroo\Magento2\Gateway\Request\AdditionalInformation\SepaDirectDebitDataBuilder</item>
                <item name="credit_management" xsi:type="string">BuckarooDefaultCreditManagment</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- SepaDirectDebit Order Command - Response Handler -->
    <virtualType name="SepaDirectDebitHandler"  type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="response" xsi:type="string">Buckaroo\Magento2\Gateway\Response\OrderHandler</item>
                <item name="credit_management" xsi:type="string">Buckaroo\Magento2\Gateway\Response\CreditManagementOrderHandler</item>
                <item name="consumer_message" xsi:type="string">Buckaroo\Magento2\Gateway\Response\ConsumerMessageHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END SepaDirectDebit Order Command -->
    <!-- END SepaDirectDebit Commands infrastructure -->
    <!-- END Payment Method: SepaDirectDebit -->


    <!-- Payment Method: Wechatpay -->
    <!-- Wechatpay Payment Method Facade configuration -->
    <virtualType name="WechatpayFacade" type="Buckaroo\Magento2\Model\Method\BuckarooAdapter">
        <arguments>
            <argument name="code" xsi:type="const">Buckaroo\Magento2\Model\ConfigProvider\Method\Wechatpay::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Buckaroo\Magento2\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">WechatpayValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">WechatpayValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">WechatpayGatewayCommandPool</argument>
            <argument name="usesRedirect" xsi:type="boolean">true</argument>
        </arguments>
    </virtualType>

    <!-- Wechatpay Value handlers infrastructure -->
    <virtualType name="WechatpayValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">WechatpayConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Configuration reader -->
    <virtualType name="WechatpayConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Buckaroo\Magento2\Model\ConfigProvider\Method\Wechatpay</argument>
        </arguments>
    </virtualType>
    <!-- END Wechatpay Value handlers infrastructure -->

    <!-- Wechatpay validators infrastructure -->
    <virtualType name="WechatpayValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="buckaroo_availability" xsi:type="string">BuckarooAvailabilityValidator</item>
                <item name="country" xsi:type="string">Buckaroo\Magento2\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- END Wechatpay validators infrastructure -->

    <!-- Wechatpay Commands infrastructure -->
    <virtualType name="WechatpayGatewayCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="order" xsi:type="string">WechatpayOrderCommand</item>
                <item name="refund" xsi:type="string">BuckarooRefundCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Wechatpay Order Command -->
    <virtualType name="WechatpayOrderCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">WechatpayOrderRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="client" xsi:type="object">TransactionPay</argument>
            <argument name="handler" xsi:type="object">OrderResponseHandler</argument>
            <argument name="validator" xsi:type="object">Buckaroo\Magento2\Gateway\Validator\ResponseCodeSDKValidator</argument>
            <argument name="errorMessageMapper" xsi:type="object">Buckaroo\Magento2\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </virtualType>

    <!-- Wechatpay Order Command - Request Builder -->
    <virtualType name="WechatpayOrderRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="order_request" xsi:type="string">BuckarooOrderRequest</item>
                <item name="locale" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddress\LocaleDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="CustomerWechatpayDataBuilder" type="Buckaroo\Magento2\Gateway\Request\BuckarooBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="billing" xsi:type="string">WechatpayBillingDataBuilder</item>
                <item name="shipping" xsi:type="string">WechatpayShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="WechatpayBillingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">Buckaroo\Magento2\Gateway\Request\Recipient\WechatpayDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\BillingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">Buckaroo\Magento2\Gateway\Request\PhoneDataBuilder</item>
                <item name="email" xsi:type="string">Buckaroo\Magento2\Gateway\Request\EmailAddressDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="WechatpayShippingDataBuilder" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="recipient" xsi:type="string">WechatpayShippingRecipientDataBuilder</item>
                <item name="address" xsi:type="string">Buckaroo\Magento2\Gateway\Request\ShippingAddressDataBuilder</item>
                <item name="phone" xsi:type="string">PhoneShippingDataBuilder</item>
                <item name="email" xsi:type="string">EmailAddressShippingDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="WechatpayShippingRecipientDataBuilder" type="Buckaroo\Magento2\Gateway\Request\Recipient\WechatpayDataBuilder">
        <arguments>
            <argument name="addressType" xsi:type="string">shipping</argument>
        </arguments>
    </virtualType>
    <!-- END Wechatpay Order Command -->
    <!-- END Wechatpay Commands infrastructure -->
    <!-- END Payment Method: Wechatpay -->

    <!-- iDIN service (Age verification) -->
    <virtualType name="IdinVerifyRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="idin" xsi:type="string">Buckaroo\Magento2\Gateway\Request\IdinDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Buckaroo\Magento2\Controller\Checkout\Idin">
        <arguments>
            <argument name="requestDataBuilder" xsi:type="object">IdinVerifyRequest</argument>
            <argument name="transferFactory" xsi:type="object">Buckaroo\Magento2\Gateway\Http\SDKTransferFactory</argument>
            <argument name="clientInterface" xsi:type="object">TransactionVerify</argument>
        </arguments>
    </type>

</config>
